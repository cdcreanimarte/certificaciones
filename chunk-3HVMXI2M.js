import{h as Ot}from"./chunk-JOZYFTCA.js";import{c as X,d as H}from"./chunk-XT64ZN6M.js";import"./chunk-X5YLR3NI.js";import"./chunk-FK6H3RFT.js";import{F as k,G as pt,H as ft,I as ut,J as gt,K as _t,L as Ct,M as xt,N as ht,O as bt,P as Mt,Q as wt,R as V,T as Pt,U as q,V as O,b as Z,c as tt,d as et,e as nt,f as it,g as ot,h as at,j as rt,k as lt,l as ct,o as R,p as mt,r as dt,x as st,y as I}from"./chunk-M23HUVHI.js";import"./chunk-2PPFUFFT.js";import{b as K,c as W}from"./chunk-XAELEFRM.js";import"./chunk-CL6E2KIN.js";import{Db as h,Ib as i,Jb as o,Kb as b,Lb as g,Mb as _,Ob as M,Rb as x,Tb as s,Ua as $,Wb as Q,Xa as l,Ya as y,Yb as z,Yc as J,Zb as F,Zc as D,_b as A,ba as S,cc as E,dc as a,eb as w,ec as C,fc as P,ja as f,ka as u,mc as U,pc as Y,rc as G,ta as T,vb as m,wb as j,xb as p}from"./chunk-37SYL4M2.js";import{i as v}from"./chunk-ODN5LVDJ.js";var L=class t{constructor(e){this.data=e}static \u0275fac=function(n){return new(n||t)(y(Z))};static \u0275cmp=w({type:t,selectors:[["app-modal-confirmation"]],decls:9,vars:2,consts:[["mat-dialog-title",""],["align","end"],["mat-button","","mat-dialog-close",""],["mat-button","","color","warn",3,"mat-dialog-close"]],template:function(n,r){n&1&&(i(0,"h2",0),a(1,"Confirmar eliminaci\xF3n"),o(),i(2,"mat-dialog-content"),a(3),o(),i(4,"mat-dialog-actions",1)(5,"button",2),a(6,"Cancelar"),o(),i(7,"button",3),a(8,"Eliminar"),o()()),n&2&&(l(3),P(" \xBFEst\xE1s seguro de que deseas eliminar el certificado de ",r.data,"? "),l(4),p("mat-dialog-close",!0))},dependencies:[O,R,et,nt,ot,it],encapsulation:2})};var Rt=()=>[5,10,25,100];function It(t,e){if(t&1){let n=M();i(0,"button",22),x("click",function(){f(n);let c=s(),d=E(4);return u(c.clearFilter(d))}),i(1,"mat-icon"),a(2,"close"),o()()}}function kt(t,e){t&1&&(i(0,"th",23),a(1,"C\xF3digo"),o())}function Vt(t,e){if(t&1&&(i(0,"td",24)(1,"span",25),a(2),o()()),t&2){let n=e.$implicit;l(2),C(n.code)}}function qt(t,e){t&1&&(i(0,"th",23),a(1,"Estudiante"),o())}function Lt(t,e){if(t&1&&(i(0,"td",24),a(1),o()),t&2){let n=e.$implicit;l(),C(n.studentName)}}function Nt(t,e){t&1&&(i(0,"th",23),a(1,"N\xFAmero Doc."),o())}function zt(t,e){if(t&1&&(i(0,"td",24)(1,"span",26),a(2),o(),a(3),o()),t&2){let n=e.$implicit;l(2),C(n.documentType),l(),P(" ",n.documentNumber," ")}}function Ft(t,e){t&1&&(i(0,"th",23),a(1,"Curso"),o())}function At(t,e){if(t&1&&(i(0,"td",24),a(1),o()),t&2){let n=e.$implicit;l(),C(n.courseName)}}function Ht(t,e){t&1&&(i(0,"th",23),a(1,"Horas"),o())}function Bt(t,e){if(t&1&&(i(0,"td",24)(1,"span",27),a(2),o()()),t&2){let n=e.$implicit;l(2),P("",n.hours," hrs")}}function $t(t,e){t&1&&(i(0,"th",23),a(1,"Email"),o())}function jt(t,e){if(t&1&&(i(0,"td",24)(1,"a",28),a(2),o()()),t&2){let n=e.$implicit;l(),Q("href","mailto:",n.email,"",$),l(),C(n.email)}}function Qt(t,e){t&1&&(i(0,"th",23),a(1,"Fecha"),o())}function Ut(t,e){if(t&1&&(i(0,"td",24),a(1),Y(2,"date"),o()),t&2){let n=e.$implicit;l(),C(G(2,1,n.created_at,"dd MMM, yyyy"))}}function Yt(t,e){t&1&&b(0,"th",29)}function Gt(t,e){if(t&1){let n=M();i(0,"td",24)(1,"div",30)(2,"button",31),x("click",function(){let c=f(n).$implicit,d=s();return u(d.onDelete(c))}),i(3,"mat-icon"),a(4,"delete"),o()()()()}t&2&&(l(2),p("matTooltip","Eliminar certificado"))}function Jt(t,e){t&1&&b(0,"tr",32)}function Kt(t,e){t&1&&b(0,"tr",33)}function Wt(t,e){if(t&1&&(i(0,"tr",20)(1,"td",34)(2,"div",35)(3,"mat-icon"),a(4,"search_off"),o(),i(5,"span"),a(6),o()()()()),t&2){let n=s(),r=E(4);l(),j("colspan",n.displayedColumns.length),l(5),P('No hay datos que coincidan con el filtro "',r.value,'"')}}var N=class t{constructor(e){this.dialog=e;this.dataSource=new V([])}sort;paginator;deleteRequest=new T;editRequest=new T;viewRequest=new T;displayedColumns=["code","studentName","documentNumber","courseName","hours","email","created_at","actions"];dataSource;set data(e){if(!e||e.length===0){this.dataSource=new V([]);return}let n=e.sort((r,c)=>{let d=r.created_at?new Date(r.created_at):new Date(0);return(c.created_at?new Date(c.created_at):new Date(0)).getTime()-d.getTime()});this.dataSource=new V(n),this.paginator&&(this.dataSource.paginator=this.paginator),this.sort&&(this.dataSource.sort=this.sort),this.setupFilterPredicate()}ngOnInit(){}ngAfterViewInit(){setTimeout(()=>{this.dataSource&&(this.paginator&&(this.dataSource.paginator=this.paginator),this.sort&&(this.dataSource.sort=this.sort))})}setupFilterPredicate(){this.dataSource.filterPredicate=(e,n)=>((e.code||"")+(e.studentName||"")+(e.documentNumber||"")+(e.courseName||"")+(e.email||"")).toLowerCase().includes(n.toLowerCase())}applyFilter(e){let n=e.target.value;this.dataSource.filter=n.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}clearFilter(e){e.value="",this.dataSource.filter="",this.dataSource.paginator&&this.dataSource.paginator.firstPage()}onDelete(e){this.dialog.open(L,{width:"350px",data:e.studentName}).afterClosed().subscribe(r=>{r&&this.deleteRequest.emit(e)})}onEdit(e){this.editRequest.emit(e)}onView(e){this.viewRequest.emit(e)}static \u0275fac=function(n){return new(n||t)(y(tt))};static \u0275cmp=w({type:t,selectors:[["app-table"]],viewQuery:function(n,r){if(n&1&&(z(k,5),z(q,5)),n&2){let c;F(c=A())&&(r.sort=c.first),F(c=A())&&(r.paginator=c.first)}},inputs:{data:"data"},outputs:{deleteRequest:"deleteRequest",editRequest:"editRequest",viewRequest:"viewRequest"},decls:38,vars:8,consts:[["input",""],["appearance","fill"],["matInput","","placeholder","Buscar por nombre, c\xF3digo, curso...",3,"keyup"],["matPrefix",""],["matSuffix","","mat-icon-button","","aria-label","Limpiar"],[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","code"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","studentName"],["matColumnDef","documentNumber"],["matColumnDef","courseName"],["matColumnDef","hours"],["matColumnDef","email"],["matColumnDef","created_at"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"mat-row","mat-no-data-row"],["showFirstLastButtons","","aria-label","Seleccionar p\xE1gina de certificados",3,"pageSizeOptions","pageSize"],["matSuffix","","mat-icon-button","","aria-label","Limpiar",3,"click"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"code-badge"],[1,"document-type"],[1,"hours-badge"],[1,"email-link",3,"href"],["mat-header-cell",""],[1,"action-buttons"],["mat-icon-button","",3,"click","matTooltip"],["mat-header-row",""],["mat-row",""],[1,"mat-cell"],[1,"no-data-message"]],template:function(n,r){if(n&1){let c=M();i(0,"mat-form-field",1)(1,"mat-label"),a(2,"Filtrar certificados"),o(),i(3,"input",2,0),x("keyup",function(B){return f(c),u(r.applyFilter(B))}),o(),i(5,"mat-icon",3),a(6,"search"),o(),m(7,It,3,0,"button",4),o(),i(8,"div",5)(9,"table",6),g(10,7),m(11,kt,2,0,"th",8)(12,Vt,3,1,"td",9),_(),g(13,10),m(14,qt,2,0,"th",8)(15,Lt,2,1,"td",9),_(),g(16,11),m(17,Nt,2,0,"th",8)(18,zt,4,2,"td",9),_(),g(19,12),m(20,Ft,2,0,"th",8)(21,At,2,1,"td",9),_(),g(22,13),m(23,Ht,2,0,"th",8)(24,Bt,3,1,"td",9),_(),g(25,14),m(26,$t,2,0,"th",8)(27,jt,3,3,"td",9),_(),g(28,15),m(29,Qt,2,0,"th",8)(30,Ut,3,4,"td",9),_(),g(31,16),m(32,Yt,1,0,"th",17)(33,Gt,5,1,"td",9),_(),m(34,Jt,1,0,"tr",18)(35,Kt,1,0,"tr",19)(36,Wt,7,2,"tr",20),o(),b(37,"mat-paginator",21),o()}if(n&2){let c=E(4);l(7),h(c.value?7:-1),l(2),p("dataSource",r.dataSource),l(25),p("matHeaderRowDef",r.displayedColumns),l(),p("matRowDefColumns",r.displayedColumns),l(),h(r.dataSource.filter&&!r.dataSource.filteredData.length?36:-1),l(),p("pageSizeOptions",U(7,Rt))("pageSize",10)}},dependencies:[O,dt,ct,at,rt,lt,I,st,q,k,pt,ft,gt,ht,_t,ut,bt,Ct,xt,Mt,wt,Pt,J,D],styles:[".mat-elevation-z8[_ngcontent-%COMP%]{overflow-x:auto;border-radius:8px;box-shadow:0 2px 10px #0000000d!important;background-color:#fff}mat-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}mat-form-field[_ngcontent-%COMP%]     .mat-form-field-wrapper{padding-bottom:0}mat-form-field[_ngcontent-%COMP%]     .mat-form-field-flex{padding:0 12px!important;align-items:center}mat-form-field[_ngcontent-%COMP%]     .mat-form-field-infix{padding:12px 0!important;border-top:0}mat-form-field[_ngcontent-%COMP%]     .mat-form-field-label{top:24px!important;transform-origin:left top!important}mat-form-field[_ngcontent-%COMP%]     .mat-form-field-label-wrapper{top:-1em;padding-top:1em}mat-form-field[_ngcontent-%COMP%]     .mat-focused .mat-form-field-label{transform:translateY(-1.5em) scale(.75)!important}mat-form-field[_ngcontent-%COMP%]     .mat-form-field-appearance-fill .mat-form-field-flex{background-color:#fff;border-radius:8px 8px 0 0;padding:12px 12px 0!important;box-shadow:0 2px 6px #0000000a}mat-form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:14px}table[_ngcontent-%COMP%]{width:100%;min-width:900px;border-collapse:separate;border-spacing:0}table[_ngcontent-%COMP%]   tr.mat-row[_ngcontent-%COMP%]{height:52px;transition:background-color .2s ease}table[_ngcontent-%COMP%]   tr.mat-row[_ngcontent-%COMP%]:hover{background-color:#00000005}table[_ngcontent-%COMP%]   tr.mat-row[_ngcontent-%COMP%]:not(:last-child){border-bottom:1px solid rgba(0,0,0,.05)}table[_ngcontent-%COMP%]   th.mat-header-cell[_ngcontent-%COMP%]{font-weight:600;color:#000000b3;font-size:13px;padding:16px 8px;border-bottom:1px solid rgba(0,0,0,.1);white-space:nowrap}table[_ngcontent-%COMP%]   th.mat-header-cell[_ngcontent-%COMP%]:first-child{padding-left:24px}table[_ngcontent-%COMP%]   th.mat-header-cell[_ngcontent-%COMP%]:last-child{padding-right:24px}table[_ngcontent-%COMP%]   td.mat-cell[_ngcontent-%COMP%]{padding:8px;color:#000c;font-size:14px}table[_ngcontent-%COMP%]   td.mat-cell[_ngcontent-%COMP%]:first-child{padding-left:24px}table[_ngcontent-%COMP%]   td.mat-cell[_ngcontent-%COMP%]:last-child{padding-right:24px}.mat-column-actions[_ngcontent-%COMP%]{width:120px;text-align:right}.mat-column-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:36px;height:36px;line-height:36px}.mat-column-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;color:#00000080;transition:color .2s ease}.mat-column-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   mat-icon[_ngcontent-%COMP%]{color:#f44336}  .mat-paginator{border-top:1px solid rgba(0,0,0,.05)}  .mat-paginator .mat-paginator-container{min-height:56px;padding:0 24px}  .mat-paginator .mat-paginator-range-label{margin:0 24px}tr.mat-row.mat-no-data-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:24px;text-align:center;color:#00000080;font-style:italic}.code-badge[_ngcontent-%COMP%]{background-color:#3f51b51a;color:#3f51b5;padding:4px 8px;border-radius:4px;font-size:12px;font-weight:500;letter-spacing:.5px}.document-type[_ngcontent-%COMP%]{color:#0009;font-size:12px;font-weight:500;margin-right:4px}.hours-badge[_ngcontent-%COMP%]{background-color:#4caf501a;color:#4caf50;padding:4px 8px;border-radius:4px;font-size:12px;font-weight:500}.email-link[_ngcontent-%COMP%]{color:#3f51b5;text-decoration:none;transition:color .2s ease}.email-link[_ngcontent-%COMP%]:hover{color:#303f9f;text-decoration:underline}.action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:4px}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(1)   mat-icon[_ngcontent-%COMP%]{color:#3f51b5}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(2)   mat-icon[_ngcontent-%COMP%]{color:#ff9800}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(3)   mat-icon[_ngcontent-%COMP%]{color:#f44336}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   mat-icon[_ngcontent-%COMP%]{transform:scale(1.2)}.no-data-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:24px 0}.no-data-message[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;height:48px;width:48px;margin-bottom:16px;color:#0000004d}.no-data-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px}"]})};function Xt(t,e){t&1&&(i(0,"div",6),b(1,"div",9),i(2,"div",10),a(3,"Cargando certificados..."),o()())}function Zt(t,e){if(t&1){let n=M();i(0,"div",7)(1,"p",11),a(2),o(),i(3,"button",12),x("click",function(){f(n);let c=s();return u(c.reloadCertificates())}),i(4,"mat-icon"),a(5,"refresh"),o(),a(6," Reintentar "),o()()}if(t&2){let n=s();l(2),C(n.error())}}function te(t,e){if(t&1){let n=M();i(0,"div",8)(1,"app-table",13),x("deleteRequest",function(c){f(n);let d=s();return u(d.onDeleteCertificate(c))})("editRequest",function(c){f(n);let d=s();return u(d.onEditCertificate(c))})("viewRequest",function(c){f(n);let d=s();return u(d.onViewCertificate(c))}),o()()}if(t&2){let n=s();l(),p("data",n.certificates())}}var yt=class t{_authSrv=S(X);_certificateSrv=S(Ot);_router=S(K);certificates=this._certificateSrv.certificates;loading=this._certificateSrv.loading;error=this._certificateSrv.error;ngOnInit(){this._certificateSrv.list()}reloadCertificates(){this._certificateSrv.list()}onEditCertificate(e){return v(this,null,function*(){this._router.navigate(["/administration/edit",e.id])})}onDeleteCertificate(e){return v(this,null,function*(){try{yield this._certificateSrv.delete(e.id),H.success("Certificado eliminado exitosamente")}catch(n){console.error("Error al eliminar:",n),H.error(n.message||"Error al eliminar el certificado")}})}logout(){return v(this,null,function*(){yield this._authSrv.logOut(),this._router.navigateByUrl("/")})}onViewCertificate(e){}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=w({type:t,selectors:[["app-certificate-list"]],decls:19,vars:3,consts:[[1,"page-container"],[1,"list-container"],[1,"header-actions"],[1,"action-buttons"],["mat-flat-button","","color","warn",3,"click"],["mat-flat-button","","color","primary","routerLink","/administration/new"],[1,"loading-container"],[1,"error-content"],[1,"table-container"],[1,"progress-bar"],[1,"loading-text"],[1,"error-message"],["mat-flat-button","","color","primary",3,"click"],[3,"deleteRequest","editRequest","viewRequest","data"]],template:function(n,r){n&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),a(4,"Certificados"),o(),i(5,"div",3)(6,"button",4),x("click",function(){return r.logout()}),i(7,"mat-icon"),a(8,"exit_to_app"),o(),i(9,"span"),a(10,"Salir"),o()(),i(11,"a",5)(12,"mat-icon"),a(13,"add"),o(),i(14,"span"),a(15,"Nuevo Certificado"),o()()()(),m(16,Xt,4,0,"div",6)(17,Zt,7,1,"div",7)(18,te,2,1,"div",8),o()()),n&2&&(l(16),h(r.loading()?16:-1),l(),h(r.error()?17:-1),l(),h(!r.loading()&&!r.error()?18:-1))},dependencies:[O,mt,R,I,N,W,D],styles:['.page-container[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}.list-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:24px;box-shadow:0 2px 12px #00000014;height:100%;display:flex;flex-direction:column}.header-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.header-actions[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:22px;font-weight:600;color:#000c;position:relative}.header-actions[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-8px;left:0;width:40px;height:3px;background-color:#3f51b5;border-radius:3px}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:12px}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .action-buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{min-width:140px;border-radius:8px;font-weight:500;padding:0 20px;height:40px;line-height:40px;text-transform:uppercase;letter-spacing:.5px;font-size:13px;transition:all .2s ease}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, .action-buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 8px #0000001a}.loading-container[_ngcontent-%COMP%]{padding:16px 0}.loading-container[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{width:100%;height:4px;background-color:#3f51b51a;border-radius:4px;overflow:hidden;position:relative}.loading-container[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;height:100%;width:30%;background-color:#3f51b5;animation:_ngcontent-%COMP%_loading 1.5s infinite ease-in-out;border-radius:4px}.loading-container[_ngcontent-%COMP%]   .loading-text[_ngcontent-%COMP%]{text-align:center;margin-top:16px;color:#0009;font-size:14px}@keyframes _ngcontent-%COMP%_loading{0%{left:-30%}to{left:100%}}.error-content[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;background-color:#f443360d;border-radius:8px;margin:20px 0}.error-content[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#f44336;margin-bottom:16px;font-size:16px;font-weight:500}.error-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:8px;padding:0 24px;height:40px;line-height:40px;font-weight:500}.table-container[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden}@media (max-width: 600px){.list-container[_ngcontent-%COMP%]{padding:16px;border-radius:8px}.header-actions[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:20px;margin-bottom:20px}.action-buttons[_ngcontent-%COMP%]{width:100%;flex-direction:column}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .action-buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{width:100%}}']})};export{yt as CertificateListComponent};
