import{b as Cs,c as Ss,f as $i,g as Es}from"./chunk-X5YLR3NI.js";import{$b as qt,Ab as De,Ac as zt,Bb as Z,Bc as S,Cc as ct,Da as vs,Db as F,Eb as ys,Ec as Ht,Fb as ws,Fc as Ts,Gb as at,Hb as lt,Ib as j,Jb as D,Kb as z,Nb as Le,Ob as ye,Rb as we,Tb as k,Tc as ks,Ub as Mt,Vb as K,Xa as U,Y as rt,Zc as ht,ac as Vt,ca as nt,cc as Ue,eb as $e,ec as Fe,hb as ot,ka as B,la as N,lc as bs,ma as _e,oc as ie,pb as V,pc as ae,qb as Nt,rc as xs,vb as $,wb as ve,xa as w,xb as X,zc as be}from"./chunk-CCAJ3PNG.js";import{a as P,b as J,c as _s,e as Q,g as Ai,h as Ii,i as d}from"./chunk-ODN5LVDJ.js";var Yt=Q(Wt=>{"use strict";Object.defineProperty(Wt,"__esModule",{value:!0});var Gt=class extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}};Wt.default=Gt});var Xt=Q(Me=>{"use strict";var Ps=Me&&Me.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Me,"__esModule",{value:!0});var Li=Ps((Es(),Ii($i))),Ui=Ps(Yt()),Qt=class{constructor(s){this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=s.headers,this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=s.shouldThrowOnError,this.signal=s.signal,this.isMaybeSingle=s.isMaybeSingle,s.fetch?this.fetch=s.fetch:typeof fetch>"u"?this.fetch=Li.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,e){return this.headers=Object.assign({},this.headers),this.headers[s]=e,this}then(s,e){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let t=this.fetch,i=t(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(n=>d(this,null,function*(){var o,a,l;let c=null,h=null,u=null,p=n.status,f=n.statusText;if(n.ok){if(this.method!=="HEAD"){let m=yield n.text();m===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?h=m:h=JSON.parse(m))}let b=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),v=(a=n.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");b&&v&&v.length>1&&(u=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(c={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,u=null,p=406,f="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{let b=yield n.text();try{c=JSON.parse(b),Array.isArray(c)&&n.status===404&&(h=[],c=null,p=200,f="OK")}catch{n.status===404&&b===""?(p=204,f="No Content"):c={message:b}}if(c&&this.isMaybeSingle&&(!((l=c?.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,p=200,f="OK"),c&&this.shouldThrowOnError)throw new Ui.default(c)}return{error:c,data:h,count:u,status:p,statusText:f}}));return this.shouldThrowOnError||(i=i.catch(n=>{var o,a,l;return{error:{message:`${(o=n?.name)!==null&&o!==void 0?o:"FetchError"}: ${n?.message}`,details:`${(a=n?.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=n?.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(s,e)}};Me.default=Qt});var es=Q(qe=>{"use strict";var Fi=qe&&qe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(qe,"__esModule",{value:!0});var Bi=Fi(Xt()),Zt=class extends Bi.default{select(s){let e=!1,t=(s??"*").split("").map(i=>/\s/.test(i)&&!e?"":(i==='"'&&(e=!e),i)).join("");return this.url.searchParams.set("select",t),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(s,{ascending:e=!0,nullsFirst:t,foreignTable:i,referencedTable:n=i}={}){let o=n?`${n}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${s}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:e,referencedTable:t=e}={}){let i=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(i,`${s}`),this}range(s,e,{foreignTable:t,referencedTable:i=t}={}){let n=typeof i>"u"?"offset":`${i}.offset`,o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(n,`${s}`),this.url.searchParams.set(o,`${e-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:s=!1,verbose:e=!1,settings:t=!1,buffers:i=!1,wal:n=!1,format:o="text"}={}){var a;let l=[s?"analyze":null,e?"verbose":null,t?"settings":null,i?"buffers":null,n?"wal":null].filter(Boolean).join("|"),c=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${c}"; options=${l};`,o==="json"?this:this}rollback(){var s;return((s=this.headers.Prefer)!==null&&s!==void 0?s:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};qe.default=Zt});var pt=Q(Ve=>{"use strict";var Ni=Ve&&Ve.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ve,"__esModule",{value:!0});var Mi=Ni(es()),ts=class extends Mi.default{eq(s,e){return this.url.searchParams.append(s,`eq.${e}`),this}neq(s,e){return this.url.searchParams.append(s,`neq.${e}`),this}gt(s,e){return this.url.searchParams.append(s,`gt.${e}`),this}gte(s,e){return this.url.searchParams.append(s,`gte.${e}`),this}lt(s,e){return this.url.searchParams.append(s,`lt.${e}`),this}lte(s,e){return this.url.searchParams.append(s,`lte.${e}`),this}like(s,e){return this.url.searchParams.append(s,`like.${e}`),this}likeAllOf(s,e){return this.url.searchParams.append(s,`like(all).{${e.join(",")}}`),this}likeAnyOf(s,e){return this.url.searchParams.append(s,`like(any).{${e.join(",")}}`),this}ilike(s,e){return this.url.searchParams.append(s,`ilike.${e}`),this}ilikeAllOf(s,e){return this.url.searchParams.append(s,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(s,e){return this.url.searchParams.append(s,`ilike(any).{${e.join(",")}}`),this}is(s,e){return this.url.searchParams.append(s,`is.${e}`),this}in(s,e){let t=Array.from(new Set(e)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(s,`in.(${t})`),this}contains(s,e){return typeof e=="string"?this.url.searchParams.append(s,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(s,`cs.{${e.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(e)}`),this}containedBy(s,e){return typeof e=="string"?this.url.searchParams.append(s,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(s,`cd.{${e.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(e)}`),this}rangeGt(s,e){return this.url.searchParams.append(s,`sr.${e}`),this}rangeGte(s,e){return this.url.searchParams.append(s,`nxl.${e}`),this}rangeLt(s,e){return this.url.searchParams.append(s,`sl.${e}`),this}rangeLte(s,e){return this.url.searchParams.append(s,`nxr.${e}`),this}rangeAdjacent(s,e){return this.url.searchParams.append(s,`adj.${e}`),this}overlaps(s,e){return typeof e=="string"?this.url.searchParams.append(s,`ov.${e}`):this.url.searchParams.append(s,`ov.{${e.join(",")}}`),this}textSearch(s,e,{config:t,type:i}={}){let n="";i==="plain"?n="pl":i==="phrase"?n="ph":i==="websearch"&&(n="w");let o=t===void 0?"":`(${t})`;return this.url.searchParams.append(s,`${n}fts${o}.${e}`),this}match(s){return Object.entries(s).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(s,e,t){return this.url.searchParams.append(s,`not.${e}.${t}`),this}or(s,{foreignTable:e,referencedTable:t=e}={}){let i=t?`${t}.or`:"or";return this.url.searchParams.append(i,`(${s})`),this}filter(s,e,t){return this.url.searchParams.append(s,`${e}.${t}`),this}};Ve.default=ts});var is=Q(He=>{"use strict";var qi=He&&He.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(He,"__esModule",{value:!0});var ze=qi(pt()),ss=class{constructor(s,{headers:e={},schema:t,fetch:i}){this.url=s,this.headers=e,this.schema=t,this.fetch=i}select(s,{head:e=!1,count:t}={}){let i=e?"HEAD":"GET",n=!1,o=(s??"*").split("").map(a=>/\s/.test(a)&&!n?"":(a==='"'&&(n=!n),a)).join("");return this.url.searchParams.set("select",o),t&&(this.headers.Prefer=`count=${t}`),new ze.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(s,{count:e,defaultToNull:t=!0}={}){let i="POST",n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),e&&n.push(`count=${e}`),t||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(s)){let o=s.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){let a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new ze.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}upsert(s,{onConflict:e,ignoreDuplicates:t=!1,count:i,defaultToNull:n=!0}={}){let o="POST",a=[`resolution=${t?"ignore":"merge"}-duplicates`];if(e!==void 0&&this.url.searchParams.set("on_conflict",e),this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),n||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(s)){let l=s.reduce((c,h)=>c.concat(Object.keys(h)),[]);if(l.length>0){let c=[...new Set(l)].map(h=>`"${h}"`);this.url.searchParams.set("columns",c.join(","))}}return new ze.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}update(s,{count:e}={}){let t="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),e&&i.push(`count=${e}`),this.headers.Prefer=i.join(","),new ze.default({method:t,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}delete({count:s}={}){let e="DELETE",t=[];return s&&t.push(`count=${s}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new ze.default({method:e,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};He.default=ss});var js=Q(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.version=void 0;mt.version="0.0.0-automated"});var Rs=Q(gt=>{"use strict";Object.defineProperty(gt,"__esModule",{value:!0});gt.DEFAULT_HEADERS=void 0;var Vi=js();gt.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Vi.version}`}});var Is=Q(Je=>{"use strict";var As=Je&&Je.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Je,"__esModule",{value:!0});var zi=As(is()),Hi=As(pt()),Ji=Rs(),rs=class r{constructor(s,{headers:e={},schema:t,fetch:i}={}){this.url=s,this.headers=Object.assign(Object.assign({},Ji.DEFAULT_HEADERS),e),this.schemaName=t,this.fetch=i}from(s){let e=new URL(`${this.url}/${s}`);return new zi.default(e,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new r(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,e={},{head:t=!1,get:i=!1,count:n}={}){let o,a=new URL(`${this.url}/rpc/${s}`),l;t||i?(o=t?"HEAD":"GET",Object.entries(e).filter(([h,u])=>u!==void 0).map(([h,u])=>[h,Array.isArray(u)?`{${u.join(",")}}`:`${u}`]).forEach(([h,u])=>{a.searchParams.append(h,u)})):(o="POST",l=e);let c=Object.assign({},this.headers);return n&&(c.Prefer=`count=${n}`),new Hi.default({method:o,url:a,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Je.default=rs});var Ns=Q(L=>{"use strict";var xe=L&&L.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(L,"__esModule",{value:!0});L.PostgrestError=L.PostgrestBuilder=L.PostgrestTransformBuilder=L.PostgrestFilterBuilder=L.PostgrestQueryBuilder=L.PostgrestClient=void 0;var $s=xe(Is());L.PostgrestClient=$s.default;var Ds=xe(is());L.PostgrestQueryBuilder=Ds.default;var Ls=xe(pt());L.PostgrestFilterBuilder=Ls.default;var Us=xe(es());L.PostgrestTransformBuilder=Us.default;var Fs=xe(Xt());L.PostgrestBuilder=Fs.default;var Bs=xe(Yt());L.PostgrestError=Bs.default;L.default={PostgrestClient:$s.default,PostgrestQueryBuilder:Ds.default,PostgrestFilterBuilder:Ls.default,PostgrestTransformBuilder:Us.default,PostgrestBuilder:Fs.default,PostgrestError:Bs.default}});var Jt={production:!1,apiUrl:"http://localhost:3000",apiDocumentTypes:"https://u0k10efyyh.execute-api.us-east-1.amazonaws.com/dev/obtenerTipoDocumento",supabaseUrl:"https://dhcndqifywojebfmqsct.supabase.co",supabaseKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRoY25kcWlmeXdvamViZm1xc2N0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzYxNzM2NTcsImV4cCI6MjA1MTc0OTY1N30.eL9QrE9xX3Y4Xu0McA8j5M_dhywHvyRwDIaRCCQQ-LE"};var Os=r=>{let s;return r?s=r:typeof fetch>"u"?s=(...e)=>import("./chunk-NPJLHOA5.js").then(({default:t})=>t(...e)):s=fetch,(...e)=>s(...e)};var Be=class extends Error{constructor(s,e="FunctionsError",t){super(s),this.name=e,this.context=t}},dt=class extends Be{constructor(s){super("Failed to send a request to the Edge Function","FunctionsFetchError",s)}},ut=class extends Be{constructor(s){super("Relay Error invoking the Edge Function","FunctionsRelayError",s)}},ft=class extends Be{constructor(s){super("Edge Function returned a non-2xx status code","FunctionsHttpError",s)}},Kt=function(r){return r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2",r}(Kt||{});var Di=function(r,s,e,t){function i(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function a(h){try{c(t.next(h))}catch(u){o(u)}}function l(h){try{c(t.throw(h))}catch(u){o(u)}}function c(h){h.done?n(h.value):i(h.value).then(a,l)}c((t=t.apply(r,s||[])).next())})},Ne=class{constructor(s,{headers:e={},customFetch:t,region:i=Kt.Any}={}){this.url=s,this.headers=e,this.region=i,this.fetch=Os(t)}setAuth(s){this.headers.Authorization=`Bearer ${s}`}invoke(s,e={}){var t;return Di(this,void 0,void 0,function*(){try{let{headers:i,method:n,body:o}=e,a={},{region:l}=e;l||(l=this.region),l&&l!=="any"&&(a["x-region"]=l);let c;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(a["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(a["Content-Type"]="application/json",c=JSON.stringify(o)));let h=yield this.fetch(`${this.url}/${s}`,{method:n||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),i),body:c}).catch(x=>{throw new dt(x)}),u=h.headers.get("x-relay-error");if(u&&u==="true")throw new ut(h);if(!h.ok)throw new ft(h);let p=((t=h.headers.get("Content-Type"))!==null&&t!==void 0?t:"text/plain").split(";")[0].trim(),f;return p==="application/json"?f=yield h.json():p==="application/octet-stream"?f=yield h.blob():p==="text/event-stream"?f=h:p==="multipart/form-data"?f=yield h.formData():f=yield h.text(),{data:f,error:null}}catch(i){return{data:null,error:i}}})}};var Ms=Ai(Ns(),1),{PostgrestClient:qs,PostgrestQueryBuilder:Kn,PostgrestFilterBuilder:Gn,PostgrestTransformBuilder:Wn,PostgrestBuilder:Yn,PostgrestError:Qn}=Ms.default;var Vs="2.11.2";var zs={"X-Client-Info":`realtime-js/${Vs}`},Hs="1.0.0",_t=1e4,Js=1e3,Te=function(r){return r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed",r}(Te||{}),q=function(r){return r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving",r}(q||{}),H=function(r){return r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token",r}(H||{}),ns=function(r){return r.websocket="websocket",r}(ns||{}),le=function(r){return r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed",r}(le||{});var vt=class{constructor(){this.HEADER_LENGTH=1}decode(s,e){return s.constructor===ArrayBuffer?e(this._binaryDecode(s)):e(typeof s=="string"?JSON.parse(s):{})}_binaryDecode(s){let e=new DataView(s),t=new TextDecoder;return this._decodeBroadcast(s,e,t)}_decodeBroadcast(s,e,t){let i=e.getUint8(1),n=e.getUint8(2),o=this.HEADER_LENGTH+2,a=t.decode(s.slice(o,o+i));o=o+i;let l=t.decode(s.slice(o,o+n));o=o+n;let c=JSON.parse(t.decode(s.slice(o,s.byteLength)));return{ref:null,topic:a,event:l,payload:c}}};var ke=class{constructor(s,e){this.callback=s,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=s,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var C=function(r){return r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange",r}(C||{}),as=(r,s,e={})=>{var t;let i=(t=e.skipTypes)!==null&&t!==void 0?t:[];return Object.keys(s).reduce((n,o)=>(n[o]=Ki(o,r,s,i),n),{})},Ki=(r,s,e,t)=>{let i=s.find(a=>a.name===r),n=i?.type,o=e[r];return n&&!t.includes(n)?Ks(n,o):os(o)},Ks=(r,s)=>{if(r.charAt(0)==="_"){let e=r.slice(1,r.length);return Qi(s,e)}switch(r){case C.bool:return Gi(s);case C.float4:case C.float8:case C.int2:case C.int4:case C.int8:case C.numeric:case C.oid:return Wi(s);case C.json:case C.jsonb:return Yi(s);case C.timestamp:return Xi(s);case C.abstime:case C.date:case C.daterange:case C.int4range:case C.int8range:case C.money:case C.reltime:case C.text:case C.time:case C.timestamptz:case C.timetz:case C.tsrange:case C.tstzrange:return os(s);default:return os(s)}},os=r=>r,Gi=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Wi=r=>{if(typeof r=="string"){let s=parseFloat(r);if(!Number.isNaN(s))return s}return r},Yi=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(s){return console.log(`JSON parse error: ${s}`),r}return r},Qi=(r,s)=>{if(typeof r!="string")return r;let e=r.length-1,t=r[e];if(r[0]==="{"&&t==="}"){let n,o=r.slice(1,e);try{n=JSON.parse("["+o+"]")}catch{n=o?o.split(","):[]}return n.map(a=>Ks(s,a))}return r},Xi=r=>typeof r=="string"?r.replace(" ","T"):r,yt=r=>{let s=r;return s=s.replace(/^ws/i,"http"),s=s.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),s.replace(/\/+$/,"")};var Ce=class{constructor(s,e,t={},i=_t){this.channel=s,this.event=e,this.payload=t,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(s){this.timeout=s,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(s){this.payload=Object.assign(Object.assign({},this.payload),s)}receive(s,e){var t;return this._hasReceived(s)&&e((t=this.receivedResp)===null||t===void 0?void 0:t.response),this.recHooks.push({status:s,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let s=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},s),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(s,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:s,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:s,response:e}){this.recHooks.filter(t=>t.status===s).forEach(t=>t.callback(e))}_hasReceived(s){return this.receivedResp&&this.receivedResp.status===s}};var Ke=class r{constructor(s,e){this.channel=s,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let t=e?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(t.state,{},i=>{let{onJoin:n,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=r.syncState(this.state,i,n,o),this.pendingDiffs.forEach(l=>{this.state=r.syncDiff(this.state,l,n,o)}),this.pendingDiffs=[],a()}),this.channel._on(t.diff,{},i=>{let{onJoin:n,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=r.syncDiff(this.state,i,n,o),a())}),this.onJoin((i,n,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:n,newPresences:o})}),this.onLeave((i,n,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:n,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(s,e,t,i){let n=this.cloneDeep(s),o=this.transformState(e),a={},l={};return this.map(n,(c,h)=>{o[c]||(l[c]=h)}),this.map(o,(c,h)=>{let u=n[c];if(u){let p=h.map(v=>v.presence_ref),f=u.map(v=>v.presence_ref),x=h.filter(v=>f.indexOf(v.presence_ref)<0),b=u.filter(v=>p.indexOf(v.presence_ref)<0);x.length>0&&(a[c]=x),b.length>0&&(l[c]=b)}else a[c]=h}),this.syncDiff(n,{joins:a,leaves:l},t,i)}static syncDiff(s,e,t,i){let{joins:n,leaves:o}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return t||(t=()=>{}),i||(i=()=>{}),this.map(n,(a,l)=>{var c;let h=(c=s[a])!==null&&c!==void 0?c:[];if(s[a]=this.cloneDeep(l),h.length>0){let u=s[a].map(f=>f.presence_ref),p=h.filter(f=>u.indexOf(f.presence_ref)<0);s[a].unshift(...p)}t(a,h,l)}),this.map(o,(a,l)=>{let c=s[a];if(!c)return;let h=l.map(u=>u.presence_ref);c=c.filter(u=>h.indexOf(u.presence_ref)<0),s[a]=c,i(a,c,l),c.length===0&&delete s[a]}),s}static map(s,e){return Object.getOwnPropertyNames(s).map(t=>e(t,s[t]))}static transformState(s){return s=this.cloneDeep(s),Object.getOwnPropertyNames(s).reduce((e,t)=>{let i=s[t];return"metas"in i?e[t]=i.metas.map(n=>(n.presence_ref=n.phx_ref,delete n.phx_ref,delete n.phx_ref_prev,n)):e[t]=i,e},{})}static cloneDeep(s){return JSON.parse(JSON.stringify(s))}onJoin(s){this.caller.onJoin=s}onLeave(s){this.caller.onLeave=s}onSync(s){this.caller.onSync=s}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var ee=function(r){return r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR",r}(ee||{});var Ge=class r{constructor(s,e={config:{}},t){this.topic=s,this.params=e,this.socket=t,this.bindings={},this.state=q.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=s.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new Ce(this,H.join,this.params,this.timeout),this.rejoinTimer=new ke(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=q.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=q.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=q.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=q.errored,this.rejoinTimer.scheduleTimeout())}),this._on(H.reply,{},(i,n)=>{this._trigger(this._replyEventName(n),i)}),this.presence=new Ke(this),this.broadcastEndpointURL=yt(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(s,e=this.timeout){var t,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{let{config:{broadcast:n,presence:o,private:a}}=this.params;this._onError(h=>s?.(ee.CHANNEL_ERROR,h)),this._onClose(()=>s?.(ee.CLOSED));let l={},c={broadcast:n,presence:o,postgres_changes:(i=(t=this.bindings.postgres_changes)===null||t===void 0?void 0:t.map(h=>h.filter))!==null&&i!==void 0?i:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",u=>d(this,[u],function*({postgres_changes:h}){var p;if(this.socket.setAuth(),h===void 0){s?.(ee.SUBSCRIBED);return}else{let f=this.bindings.postgres_changes,x=(p=f?.length)!==null&&p!==void 0?p:0,b=[];for(let v=0;v<x;v++){let m=f[v],{filter:{event:g,schema:T,table:O,filter:A}}=m,I=h&&h[v];if(I&&I.event===g&&I.schema===T&&I.table===O&&I.filter===A)b.push(Object.assign(Object.assign({},m),{id:I.id}));else{this.unsubscribe(),s?.(ee.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,s&&s(ee.SUBSCRIBED);return}})).receive("error",h=>{s?.(ee.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{s?.(ee.TIMED_OUT)})}return this}presenceState(){return this.presence.state}track(t){return d(this,arguments,function*(s,e={}){return yield this.send({type:"presence",event:"track",payload:s},e.timeout||this.timeout)})}untrack(){return d(this,arguments,function*(s={}){return yield this.send({type:"presence",event:"untrack"},s)})}on(s,e,t){return this._on(s,e,t)}send(t){return d(this,arguments,function*(s,e={}){var i,n;if(!this._canPush()&&s.type==="broadcast"){let{event:o,payload:a}=s,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:a,private:this.private}]})};try{let h=yield this._fetchWithTimeout(this.broadcastEndpointURL,c,(i=e.timeout)!==null&&i!==void 0?i:this.timeout);return yield(n=h.body)===null||n===void 0?void 0:n.cancel(),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var a,l,c;let h=this._push(s.type,s,e.timeout||this.timeout);s.type==="broadcast"&&!(!((c=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),h.receive("ok",()=>o("ok")),h.receive("error",()=>o("error")),h.receive("timeout",()=>o("timed out"))})})}updateJoinPayload(s){this.joinPush.updatePayload(s)}unsubscribe(s=this.timeout){this.state=q.leaving;let e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(H.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(t=>{let i=new Ce(this,H.leave,{},s);i.receive("ok",()=>{e(),t("ok")}).receive("timeout",()=>{e(),t("timed out")}).receive("error",()=>{t("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}_fetchWithTimeout(s,e,t){return d(this,null,function*(){let i=new AbortController,n=setTimeout(()=>i.abort(),t),o=yield this.socket.fetch(s,Object.assign(Object.assign({},e),{signal:i.signal}));return clearTimeout(n),o})}_push(s,e,t=this.timeout){if(!this.joinedOnce)throw`tried to push '${s}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Ce(this,s,e,t);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(s,e,t){return e}_isMember(s){return this.topic===s}_joinRef(){return this.joinPush.ref}_trigger(s,e,t){var i,n;let o=s.toLocaleLowerCase(),{close:a,error:l,leave:c,join:h}=H;if(t&&[a,l,c,h].indexOf(o)>=0&&t!==this._joinRef())return;let p=this._onMessage(o,e,t);if(e&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(f=>{var x,b,v;return((x=f.filter)===null||x===void 0?void 0:x.event)==="*"||((v=(b=f.filter)===null||b===void 0?void 0:b.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(f=>f.callback(p,t)):(n=this.bindings[o])===null||n===void 0||n.filter(f=>{var x,b,v,m,g,T;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){let O=f.id,A=(x=f.filter)===null||x===void 0?void 0:x.event;return O&&((b=e.ids)===null||b===void 0?void 0:b.includes(O))&&(A==="*"||A?.toLocaleLowerCase()===((v=e.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{let O=(g=(m=f?.filter)===null||m===void 0?void 0:m.event)===null||g===void 0?void 0:g.toLocaleLowerCase();return O==="*"||O===((T=e?.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof p=="object"&&"ids"in p){let x=p.data,{schema:b,table:v,commit_timestamp:m,type:g,errors:T}=x;p=Object.assign(Object.assign({},{schema:b,table:v,commit_timestamp:m,eventType:g,new:{},old:{},errors:T}),this._getPayloadRecords(x))}f.callback(p,t)})}_isClosed(){return this.state===q.closed}_isJoined(){return this.state===q.joined}_isJoining(){return this.state===q.joining}_isLeaving(){return this.state===q.leaving}_replyEventName(s){return`chan_reply_${s}`}_on(s,e,t){let i=s.toLocaleLowerCase(),n={type:i,filter:e,callback:t};return this.bindings[i]?this.bindings[i].push(n):this.bindings[i]=[n],this}_off(s,e){let t=s.toLocaleLowerCase();return this.bindings[t]=this.bindings[t].filter(i=>{var n;return!(((n=i.type)===null||n===void 0?void 0:n.toLocaleLowerCase())===t&&r.isEqual(i.filter,e))}),this}static isEqual(s,e){if(Object.keys(s).length!==Object.keys(e).length)return!1;for(let t in s)if(s[t]!==e[t])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(s){this._on(H.close,{},s)}_onError(s){this._on(H.error,{},e=>s(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(s=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=q.joining,this.joinPush.resend(s))}_getPayloadRecords(s){let e={new:{},old:{}};return(s.type==="INSERT"||s.type==="UPDATE")&&(e.new=as(s.columns,s.record)),(s.type==="UPDATE"||s.type==="DELETE")&&(e.old=as(s.columns,s.old_record)),e}};var er=()=>{},tr=typeof WebSocket<"u",sr=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`,We=class{constructor(s,e){var t;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=zs,this.params={},this.timeout=_t,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=er,this.conn=null,this.sendBuffer=[],this.serializer=new vt,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=n=>{let o;return n?o=n:typeof fetch>"u"?o=(...a)=>import("./chunk-NPJLHOA5.js").then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${s}/${ns.websocket}`,this.httpEndpoint=yt(s),e?.transport?this.transport=e.transport:this.transport=null,e?.params&&(this.params=e.params),e?.headers&&(this.headers=Object.assign(Object.assign({},this.headers),e.headers)),e?.timeout&&(this.timeout=e.timeout),e?.logger&&(this.logger=e.logger),e?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs);let i=(t=e?.params)===null||t===void 0?void 0:t.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=e?.reconnectAfterMs?e.reconnectAfterMs:n=>[1e3,2e3,5e3,1e4][n-1]||1e4,this.encode=e?.encode?e.encode:(n,o)=>o(JSON.stringify(n)),this.decode=e?.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new ke(()=>d(this,null,function*(){this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(e?.fetch),e?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=e?.worker||!1,this.workerUrl=e?.workerUrl}this.accessToken=e?.accessToken||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(tr){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new ls(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),import("./chunk-GFTZZNGD.js").then(({default:s})=>{this.conn=new s(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Hs}))}disconnect(s,e){this.conn&&(this.conn.onclose=function(){},s?this.conn.close(s,e??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}removeChannel(s){return d(this,null,function*(){let e=yield s.unsubscribe();return this.channels.length===0&&this.disconnect(),e})}removeAllChannels(){return d(this,null,function*(){let s=yield Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),s})}log(s,e,t){this.logger(s,e,t)}connectionState(){switch(this.conn&&this.conn.readyState){case Te.connecting:return le.Connecting;case Te.open:return le.Open;case Te.closing:return le.Closing;default:return le.Closed}}isConnected(){return this.connectionState()===le.Open}channel(s,e={config:{}}){let t=new Ge(`realtime:${s}`,e,this);return this.channels.push(t),t}push(s){let{topic:e,event:t,payload:i,ref:n}=s,o=()=>{this.encode(s,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${e} ${t} (${n})`,i),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(s=null){return d(this,null,function*(){let e=s||this.accessToken&&(yield this.accessToken())||this.accessTokenValue;if(e){let t=null;try{t=JSON.parse(atob(e.split(".")[1]))}catch{}if(t&&t.exp&&!(Math.floor(Date.now()/1e3)-t.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${t.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${t.exp}`);this.accessTokenValue=e,this.channels.forEach(i=>{e&&i.updateJoinPayload({access_token:e}),i.joinedOnce&&i._isJoined()&&i._push(H.access_token,{access_token:e})})}})}sendHeartbeat(){return d(this,null,function*(){var s;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(s=this.conn)===null||s===void 0||s.close(Js,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}})}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(s=>s()),this.sendBuffer=[])}_makeRef(){let s=this.ref+1;return s===this.ref?this.ref=0:this.ref=s,this.ref.toString()}_leaveOpenTopic(s){let e=this.channels.find(t=>t.topic===s&&(t._isJoined()||t._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${s}"`),e.unsubscribe())}_remove(s){this.channels=this.channels.filter(e=>e._joinRef()!==s._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=s=>this._onConnError(s),this.conn.onmessage=s=>this._onConnMessage(s),this.conn.onclose=s=>this._onConnClose(s))}_onConnMessage(s){this.decode(s.data,e=>{let{topic:t,event:i,payload:n,ref:o}=e;o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${n.status||""} ${t} ${i} ${o&&"("+o+")"||""}`,n),this.channels.filter(a=>a._isMember(t)).forEach(a=>a._trigger(i,n,o)),this.stateChangeCallbacks.message.forEach(a=>a(e))})}_onConnOpen(){return d(this,null,function*(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let s=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(s),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(s=>s())})}_onConnClose(s){this.log("transport","close",s),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(s))}_onConnError(s){this.log("transport",s.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(s))}_triggerChanError(){this.channels.forEach(s=>s._trigger(H.error))}_appendParams(s,e){if(Object.keys(e).length===0)return s;let t=s.match(/\?/)?"&":"?",i=new URLSearchParams(e);return`${s}${t}${i}`}_workerObjectUrl(s){let e;if(s)e=s;else{let t=new Blob([sr],{type:"application/javascript"});e=URL.createObjectURL(t)}return e}};var ls=class{constructor(s,e,t){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Te.connecting,this.send=()=>{},this.url=null,this.url=s,this.close=t.close}};var Se=class extends Error{constructor(s){super(s),this.__isStorageError=!0,this.name="StorageError"}};function E(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}var wt=class extends Se{constructor(s,e){super(s),this.name="StorageApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}},ce=class extends Se{constructor(s,e){super(s),this.name="StorageUnknownError",this.originalError=e}};var ir=function(r,s,e,t){function i(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function a(h){try{c(t.next(h))}catch(u){o(u)}}function l(h){try{c(t.throw(h))}catch(u){o(u)}}function c(h){h.done?n(h.value):i(h.value).then(a,l)}c((t=t.apply(r,s||[])).next())})},xt=r=>{let s;return r?s=r:typeof fetch>"u"?s=(...e)=>import("./chunk-NPJLHOA5.js").then(({default:t})=>t(...e)):s=fetch,(...e)=>s(...e)},Gs=()=>ir(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield import("./chunk-NPJLHOA5.js")).Response:Response}),bt=r=>{if(Array.isArray(r))return r.map(e=>bt(e));if(typeof r=="function"||r!==Object(r))return r;let s={};return Object.entries(r).forEach(([e,t])=>{let i=e.replace(/([-_][a-z])/gi,n=>n.toUpperCase().replace(/[-_]/g,""));s[i]=bt(t)}),s};var he=function(r,s,e,t){function i(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function a(h){try{c(t.next(h))}catch(u){o(u)}}function l(h){try{c(t.throw(h))}catch(u){o(u)}}function c(h){h.done?n(h.value):i(h.value).then(a,l)}c((t=t.apply(r,s||[])).next())})},cs=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),rr=(r,s,e)=>he(void 0,void 0,void 0,function*(){let t=yield Gs();r instanceof t&&!e?.noResolveJson?r.json().then(i=>{s(new wt(cs(i),r.status||500))}).catch(i=>{s(new ce(cs(i),i))}):s(new ce(cs(r),r))}),nr=(r,s,e,t)=>{let i={method:r,headers:s?.headers||{}};return r==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},s?.headers),t&&(i.body=JSON.stringify(t)),Object.assign(Object.assign({},i),e))};function Ye(r,s,e,t,i,n){return he(this,void 0,void 0,function*(){return new Promise((o,a)=>{r(e,nr(s,t,i,n)).then(l=>{if(!l.ok)throw l;return t?.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>rr(l,a,t))})})}function Ee(r,s,e,t){return he(this,void 0,void 0,function*(){return Ye(r,"GET",s,e,t)})}function W(r,s,e,t,i){return he(this,void 0,void 0,function*(){return Ye(r,"POST",s,t,i,e)})}function Ws(r,s,e,t,i){return he(this,void 0,void 0,function*(){return Ye(r,"PUT",s,t,i,e)})}function Ys(r,s,e,t){return he(this,void 0,void 0,function*(){return Ye(r,"HEAD",s,Object.assign(Object.assign({},e),{noResolveJson:!0}),t)})}function Tt(r,s,e,t,i){return he(this,void 0,void 0,function*(){return Ye(r,"DELETE",s,t,i,e)})}var M=function(r,s,e,t){function i(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function a(h){try{c(t.next(h))}catch(u){o(u)}}function l(h){try{c(t.throw(h))}catch(u){o(u)}}function c(h){h.done?n(h.value):i(h.value).then(a,l)}c((t=t.apply(r,s||[])).next())})},or={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Qs={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1},kt=class{constructor(s,e={},t,i){this.url=s,this.headers=e,this.bucketId=t,this.fetch=xt(i)}uploadOrUpdate(s,e,t,i){return M(this,void 0,void 0,function*(){try{let n,o=Object.assign(Object.assign({},Qs),i),a=Object.assign(Object.assign({},this.headers),s==="POST"&&{"x-upsert":String(o.upsert)}),l=o.metadata;typeof Blob<"u"&&t instanceof Blob?(n=new FormData,n.append("cacheControl",o.cacheControl),l&&n.append("metadata",this.encodeMetadata(l)),n.append("",t)):typeof FormData<"u"&&t instanceof FormData?(n=t,n.append("cacheControl",o.cacheControl),l&&n.append("metadata",this.encodeMetadata(l))):(n=t,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i?.headers&&(a=Object.assign(Object.assign({},a),i.headers));let c=this._removeEmptyFolders(e),h=this._getFinalPath(c),u=yield this.fetch(`${this.url}/object/${h}`,Object.assign({method:s,body:n,headers:a},o?.duplex?{duplex:o.duplex}:{})),p=yield u.json();return u.ok?{data:{path:c,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(n){if(E(n))return{data:null,error:n};throw n}})}upload(s,e,t){return M(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",s,e,t)})}uploadToSignedUrl(s,e,t,i){return M(this,void 0,void 0,function*(){let n=this._removeEmptyFolders(s),o=this._getFinalPath(n),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",e);try{let l,c=Object.assign({upsert:Qs.upsert},i),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&t instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",t)):typeof FormData<"u"&&t instanceof FormData?(l=t,l.append("cacheControl",c.cacheControl)):(l=t,h["cache-control"]=`max-age=${c.cacheControl}`,h["content-type"]=c.contentType);let u=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:h}),p=yield u.json();return u.ok?{data:{path:n,fullPath:p.Key},error:null}:{data:null,error:p}}catch(l){if(E(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(s,e){return M(this,void 0,void 0,function*(){try{let t=this._getFinalPath(s),i=Object.assign({},this.headers);e?.upsert&&(i["x-upsert"]="true");let n=yield W(this.fetch,`${this.url}/object/upload/sign/${t}`,{},{headers:i}),o=new URL(this.url+n.url),a=o.searchParams.get("token");if(!a)throw new Se("No token returned by API");return{data:{signedUrl:o.toString(),path:s,token:a},error:null}}catch(t){if(E(t))return{data:null,error:t};throw t}})}update(s,e,t){return M(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",s,e,t)})}move(s,e,t){return M(this,void 0,void 0,function*(){try{return{data:yield W(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:s,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(E(i))return{data:null,error:i};throw i}})}copy(s,e,t){return M(this,void 0,void 0,function*(){try{return{data:{path:(yield W(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:s,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(E(i))return{data:null,error:i};throw i}})}createSignedUrl(s,e,t){return M(this,void 0,void 0,function*(){try{let i=this._getFinalPath(s),n=yield W(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:e},t?.transform?{transform:t.transform}:{}),{headers:this.headers}),o=t?.download?`&download=${t.download===!0?"":t.download}`:"";return n={signedUrl:encodeURI(`${this.url}${n.signedURL}${o}`)},{data:n,error:null}}catch(i){if(E(i))return{data:null,error:i};throw i}})}createSignedUrls(s,e,t){return M(this,void 0,void 0,function*(){try{let i=yield W(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:s},{headers:this.headers}),n=t?.download?`&download=${t.download===!0?"":t.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${n}`):null})),error:null}}catch(i){if(E(i))return{data:null,error:i};throw i}})}download(s,e){return M(this,void 0,void 0,function*(){let i=typeof e?.transform<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString(e?.transform||{}),o=n?`?${n}`:"";try{let a=this._getFinalPath(s);return{data:yield(yield Ee(this.fetch,`${this.url}/${i}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(E(a))return{data:null,error:a};throw a}})}info(s){return M(this,void 0,void 0,function*(){let e=this._getFinalPath(s);try{let t=yield Ee(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:bt(t),error:null}}catch(t){if(E(t))return{data:null,error:t};throw t}})}exists(s){return M(this,void 0,void 0,function*(){let e=this._getFinalPath(s);try{return yield Ys(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(t){if(E(t)&&t instanceof ce){let i=t.originalError;if([400,404].includes(i?.status))return{data:!1,error:t}}throw t}})}getPublicUrl(s,e){let t=this._getFinalPath(s),i=[],n=e?.download?`download=${e.download===!0?"":e.download}`:"";n!==""&&i.push(n);let a=typeof e?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(e?.transform||{});l!==""&&i.push(l);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${t}${c}`)}}}remove(s){return M(this,void 0,void 0,function*(){try{return{data:yield Tt(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:s},{headers:this.headers}),error:null}}catch(e){if(E(e))return{data:null,error:e};throw e}})}list(s,e,t){return M(this,void 0,void 0,function*(){try{let i=Object.assign(Object.assign(Object.assign({},or),e),{prefix:s||""});return{data:yield W(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},t),error:null}}catch(i){if(E(i))return{data:null,error:i};throw i}})}encodeMetadata(s){return JSON.stringify(s)}toBase64(s){return typeof Buffer<"u"?Buffer.from(s).toString("base64"):btoa(s)}_getFinalPath(s){return`${this.bucketId}/${s}`}_removeEmptyFolders(s){return s.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(s){let e=[];return s.width&&e.push(`width=${s.width}`),s.height&&e.push(`height=${s.height}`),s.resize&&e.push(`resize=${s.resize}`),s.format&&e.push(`format=${s.format}`),s.quality&&e.push(`quality=${s.quality}`),e.join("&")}};var Xs="2.7.1";var Zs={"X-Client-Info":`storage-js/${Xs}`};var Oe=function(r,s,e,t){function i(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function a(h){try{c(t.next(h))}catch(u){o(u)}}function l(h){try{c(t.throw(h))}catch(u){o(u)}}function c(h){h.done?n(h.value):i(h.value).then(a,l)}c((t=t.apply(r,s||[])).next())})},Ct=class{constructor(s,e={},t){this.url=s,this.headers=Object.assign(Object.assign({},Zs),e),this.fetch=xt(t)}listBuckets(){return Oe(this,void 0,void 0,function*(){try{return{data:yield Ee(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(s){if(E(s))return{data:null,error:s};throw s}})}getBucket(s){return Oe(this,void 0,void 0,function*(){try{return{data:yield Ee(this.fetch,`${this.url}/bucket/${s}`,{headers:this.headers}),error:null}}catch(e){if(E(e))return{data:null,error:e};throw e}})}createBucket(s,e={public:!1}){return Oe(this,void 0,void 0,function*(){try{return{data:yield W(this.fetch,`${this.url}/bucket`,{id:s,name:s,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(E(t))return{data:null,error:t};throw t}})}updateBucket(s,e){return Oe(this,void 0,void 0,function*(){try{return{data:yield Ws(this.fetch,`${this.url}/bucket/${s}`,{id:s,name:s,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(E(t))return{data:null,error:t};throw t}})}emptyBucket(s){return Oe(this,void 0,void 0,function*(){try{return{data:yield W(this.fetch,`${this.url}/bucket/${s}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(E(e))return{data:null,error:e};throw e}})}deleteBucket(s){return Oe(this,void 0,void 0,function*(){try{return{data:yield Tt(this.fetch,`${this.url}/bucket/${s}`,{},{headers:this.headers}),error:null}}catch(e){if(E(e))return{data:null,error:e};throw e}})}};var Qe=class extends Ct{constructor(s,e={},t){super(s,e,t)}from(s){return new kt(this.url,this.headers,s,this.fetch)}};var ei="2.47.10";var Xe="";typeof Deno<"u"?Xe="deno":typeof document<"u"?Xe="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Xe="react-native":Xe="node";var ar={"X-Client-Info":`supabase-js-${Xe}/${ei}`},ti={headers:ar},si={schema:"public"},ii={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ri={};Es();var lr=function(r,s,e,t){function i(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function a(h){try{c(t.next(h))}catch(u){o(u)}}function l(h){try{c(t.throw(h))}catch(u){o(u)}}function c(h){h.done?n(h.value):i(h.value).then(a,l)}c((t=t.apply(r,s||[])).next())})},cr=r=>{let s;return r?s=r:typeof fetch>"u"?s=Cs:s=fetch,(...e)=>s(...e)},hr=()=>typeof Headers>"u"?Ss:Headers,ni=(r,s,e)=>{let t=cr(e),i=hr();return(n,o)=>lr(void 0,void 0,void 0,function*(){var a;let l=(a=yield s())!==null&&a!==void 0?a:r,c=new i(o?.headers);return c.has("apikey")||c.set("apikey",r),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),t(n,Object.assign(Object.assign({},o),{headers:c}))})};var dr=function(r,s,e,t){function i(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function a(h){try{c(t.next(h))}catch(u){o(u)}}function l(h){try{c(t.throw(h))}catch(u){o(u)}}function c(h){h.done?n(h.value):i(h.value).then(a,l)}c((t=t.apply(r,s||[])).next())})};function oi(r){return r.replace(/\/$/,"")}function ai(r,s){let{db:e,auth:t,realtime:i,global:n}=r,{db:o,auth:a,realtime:l,global:c}=s,h={db:Object.assign(Object.assign({},o),e),auth:Object.assign(Object.assign({},a),t),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},c),n),accessToken:()=>dr(this,void 0,void 0,function*(){return""})};return r.accessToken?h.accessToken=r.accessToken:delete h.accessToken,h}function li(r){return Math.round(Date.now()/1e3)+r}function ci(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){let s=Math.random()*16|0;return(r=="x"?s:s&3|8).toString(16)})}var G=()=>typeof document<"u",de={tested:!1,writable:!1},re=()=>{if(!G())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(de.tested)return de.writable;let r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),de.tested=!0,de.writable=!0}catch{de.tested=!0,de.writable=!1}return de.writable};function St(r){let s={},e=new URL(r);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((i,n)=>{s[n]=i})}catch{}return e.searchParams.forEach((t,i)=>{s[i]=t}),s}var Et=r=>{let s;return r?s=r:typeof fetch>"u"?s=(...e)=>import("./chunk-NPJLHOA5.js").then(({default:t})=>t(...e)):s=fetch,(...e)=>s(...e)},hi=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",ne=(r,s,e)=>d(void 0,null,function*(){yield r.setItem(s,JSON.stringify(e))}),et=(r,s)=>d(void 0,null,function*(){let e=yield r.getItem(s);if(!e)return null;try{return JSON.parse(e)}catch{return e}}),Ot=(r,s)=>d(void 0,null,function*(){yield r.removeItem(s)});function ur(r){let s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e="",t,i,n,o,a,l,c,h=0;for(r=r.replace("-","+").replace("_","/");h<r.length;)o=s.indexOf(r.charAt(h++)),a=s.indexOf(r.charAt(h++)),l=s.indexOf(r.charAt(h++)),c=s.indexOf(r.charAt(h++)),t=o<<2|a>>4,i=(a&15)<<4|l>>2,n=(l&3)<<6|c,e=e+String.fromCharCode(t),l!=64&&i!=0&&(e=e+String.fromCharCode(i)),c!=64&&n!=0&&(e=e+String.fromCharCode(n));return e}var Ze=class r{constructor(){this.promise=new r.promiseConstructor((s,e)=>{this.resolve=s,this.reject=e})}};Ze.promiseConstructor=Promise;function hs(r){let s=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,e=r.split(".");if(e.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!s.test(e[1]))throw new Error("JWT is not valid: payload is not in base64url format");let t=e[1];return JSON.parse(ur(t))}function di(r){return d(this,null,function*(){return yield new Promise(s=>{setTimeout(()=>s(null),r)})})}function ui(r,s){return new Promise((t,i)=>{d(this,null,function*(){for(let n=0;n<1/0;n++)try{let o=yield r(n);if(!s(n,null,o)){t(o);return}}catch(o){if(!s(n,o)){i(o);return}}})})}function fr(r){return("0"+r.toString(16)).substr(-2)}function ue(){let s=new Uint32Array(56);if(typeof crypto>"u"){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,i="";for(let n=0;n<56;n++)i+=e.charAt(Math.floor(Math.random()*t));return i}return crypto.getRandomValues(s),Array.from(s,fr).join("")}function pr(r){return d(this,null,function*(){let e=new TextEncoder().encode(r),t=yield crypto.subtle.digest("SHA-256",e),i=new Uint8Array(t);return Array.from(i).map(n=>String.fromCharCode(n)).join("")})}function mr(r){return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function fe(r){return d(this,null,function*(){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;let e=yield pr(r);return mr(e)})}var tt=class extends Error{constructor(s,e){super(s),this.__isAuthError=!0,this.name="AuthError",this.status=e}};function _(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}var Pt=class extends tt{constructor(s,e){super(s,e),this.name="AuthApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}};function fi(r){return _(r)&&r.name==="AuthApiError"}var Pe=class extends tt{constructor(s,e){super(s),this.name="AuthUnknownError",this.originalError=e}},te=class extends tt{constructor(s,e,t){super(s),this.name=e,this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}},se=class extends te{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}},je=class extends te{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}},pe=class extends te{constructor(s){super(s,"AuthInvalidCredentialsError",400)}},me=class extends te{constructor(s,e=null){super(s,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},st=class extends te{constructor(s,e=null){super(s,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},Re=class extends te{constructor(s,e){super(s,"AuthRetryableFetchError",e)}};function Rt(r){return _(r)&&r.name==="AuthRetryableFetchError"}var jt=class extends te{constructor(s,e,t){super(s,"AuthWeakPasswordError",e),this.reasons=t}};var gr=function(r,s){var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&s.indexOf(t)<0&&(e[t]=r[t]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,t=Object.getOwnPropertySymbols(r);i<t.length;i++)s.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(r,t[i])&&(e[t[i]]=r[t[i]]);return e},Ae=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),_r=[502,503,504];function pi(r){return d(this,null,function*(){if(!hi(r))throw new Re(Ae(r),0);if(_r.includes(r.status))throw new Re(Ae(r),r.status);let s;try{s=yield r.json()}catch(e){throw new Pe(Ae(e),e)}throw typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((e,t)=>e&&typeof t=="string",!0)?new jt(Ae(s),r.status,s.weak_password.reasons):new Pt(Ae(s),r.status||500)})}var vr=(r,s,e,t)=>{let i={method:r,headers:s?.headers||{}};return r==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},s?.headers),i.body=JSON.stringify(t),Object.assign(Object.assign({},i),e))};function y(r,s,e,t){return d(this,null,function*(){var i;let n=Object.assign({},t?.headers);t?.jwt&&(n.Authorization=`Bearer ${t.jwt}`);let o=(i=t?.query)!==null&&i!==void 0?i:{};t?.redirectTo&&(o.redirect_to=t.redirectTo);let a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=yield yr(r,s,e+a,{headers:n,noResolveJson:t?.noResolveJson},{},t?.body);return t?.xform?t?.xform(l):{data:Object.assign({},l),error:null}})}function yr(r,s,e,t,i,n){return d(this,null,function*(){let o=vr(s,t,i,n),a;try{a=yield r(e,o)}catch(l){throw console.error(l),new Re(Ae(l),0)}if(a.ok||(yield pi(a)),t?.noResolveJson)return a;try{return yield a.json()}catch(l){yield pi(l)}})}function oe(r){var s;let e=null;wr(r)&&(e=Object.assign({},r),r.expires_at||(e.expires_at=li(r.expires_in)));let t=(s=r.user)!==null&&s!==void 0?s:r;return{data:{session:e,user:t},error:null}}function ds(r){let s=oe(r);return!s.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((e,t)=>e&&typeof t=="string",!0)&&(s.data.weak_password=r.weak_password),s}function Y(r){var s;return{data:{user:(s=r.user)!==null&&s!==void 0?s:r},error:null}}function mi(r){return{data:r,error:null}}function gi(r){let{action_link:s,email_otp:e,hashed_token:t,redirect_to:i,verification_type:n}=r,o=gr(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:s,email_otp:e,hashed_token:t,redirect_to:i,verification_type:n},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function _i(r){return r}function wr(r){return r.access_token&&r.refresh_token&&r.expires_in}var br=function(r,s){var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&s.indexOf(t)<0&&(e[t]=r[t]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,t=Object.getOwnPropertySymbols(r);i<t.length;i++)s.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(r,t[i])&&(e[t[i]]=r[t[i]]);return e},Ie=class{constructor({url:s="",headers:e={},fetch:t}){this.url=s,this.headers=e,this.fetch=Et(t),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(s,e="global"){return d(this,null,function*(){try{return yield y(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:s,noResolveJson:!0}),{data:null,error:null}}catch(t){if(_(t))return{data:null,error:t};throw t}})}inviteUserByEmail(t){return d(this,arguments,function*(s,e={}){try{return yield y(this.fetch,"POST",`${this.url}/invite`,{body:{email:s,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:Y})}catch(i){if(_(i))return{data:{user:null},error:i};throw i}})}generateLink(s){return d(this,null,function*(){try{let{options:e}=s,t=br(s,["options"]),i=Object.assign(Object.assign({},t),e);return"newEmail"in t&&(i.new_email=t?.newEmail,delete i.newEmail),yield y(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:gi,redirectTo:e?.redirectTo})}catch(e){if(_(e))return{data:{properties:null,user:null},error:e};throw e}})}createUser(s){return d(this,null,function*(){try{return yield y(this.fetch,"POST",`${this.url}/admin/users`,{body:s,headers:this.headers,xform:Y})}catch(e){if(_(e))return{data:{user:null},error:e};throw e}})}listUsers(s){return d(this,null,function*(){var e,t,i,n,o,a,l;try{let c={nextPage:null,lastPage:0,total:0},h=yield y(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(t=(e=s?.page)===null||e===void 0?void 0:e.toString())!==null&&t!==void 0?t:"",per_page:(n=(i=s?.perPage)===null||i===void 0?void 0:i.toString())!==null&&n!==void 0?n:""},xform:_i});if(h.error)throw h.error;let u=yield h.json(),p=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=h.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(x=>{let b=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(x.split(";")[1].split("=")[1]);c[`${v}Page`]=b}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},u),c),error:null}}catch(c){if(_(c))return{data:{users:[]},error:c};throw c}})}getUserById(s){return d(this,null,function*(){try{return yield y(this.fetch,"GET",`${this.url}/admin/users/${s}`,{headers:this.headers,xform:Y})}catch(e){if(_(e))return{data:{user:null},error:e};throw e}})}updateUserById(s,e){return d(this,null,function*(){try{return yield y(this.fetch,"PUT",`${this.url}/admin/users/${s}`,{body:e,headers:this.headers,xform:Y})}catch(t){if(_(t))return{data:{user:null},error:t};throw t}})}deleteUser(s,e=!1){return d(this,null,function*(){try{return yield y(this.fetch,"DELETE",`${this.url}/admin/users/${s}`,{headers:this.headers,body:{should_soft_delete:e},xform:Y})}catch(t){if(_(t))return{data:{user:null},error:t};throw t}})}_listFactors(s){return d(this,null,function*(){try{let{data:e,error:t}=yield y(this.fetch,"GET",`${this.url}/admin/users/${s.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:e,error:t}}catch(e){if(_(e))return{data:null,error:e};throw e}})}_deleteFactor(s){return d(this,null,function*(){try{return{data:yield y(this.fetch,"DELETE",`${this.url}/admin/users/${s.userId}/factors/${s.id}`,{headers:this.headers}),error:null}}catch(e){if(_(e))return{data:null,error:e};throw e}})}};var At="2.61.0";var vi="http://localhost:9999",yi="supabase.auth.token";var wi={"X-Client-Info":`gotrue-js/${At}`},us=10;var bi={getItem:r=>re()?globalThis.localStorage.getItem(r):null,setItem:(r,s)=>{re()&&globalThis.localStorage.setItem(r,s)},removeItem:r=>{re()&&globalThis.localStorage.removeItem(r)}};function fs(r={}){return{getItem:s=>r[s]||null,setItem:(s,e)=>{r[s]=e},removeItem:s=>{delete r[s]}}}function xi(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}var xr={debug:!!(globalThis&&re()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")},It=class extends Error{constructor(s){super(s),this.isAcquireTimeout=!0}};xi();var Tr={url:vi,storageKey:yi,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:wi,flowType:"implicit",debug:!1},it=30*1e3,Ti=3;function kr(r,s,e){return d(this,null,function*(){return yield e()})}var ps=(()=>{class r{constructor(e){var t;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=r.nextInstanceID,r.nextInstanceID+=1,this.instanceID>0&&G()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let i=Object.assign(Object.assign({},Tr),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Ie({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Et(i.fetch),this.lock=i.lock||kr,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:re()?this.storage=bi:(this.memoryStorage={},this.storage=fs(this.memoryStorage)):(this.memoryStorage={},this.storage=fs(this.memoryStorage)),G()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(n){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",n)}(t=this.broadcastChannel)===null||t===void 0||t.addEventListener("message",n=>d(this,null,function*(){this._debug("received broadcast notification from other tab or client",n),yield this._notifyAllSubscribers(n.data.event,n.data.session,!1)}))}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${At}) ${new Date().toISOString()}`,...e),this}initialize(){return d(this,null,function*(){return this.initializePromise?yield this.initializePromise:(this.initializePromise=d(this,null,function*(){return yield this._acquireLock(-1,()=>d(this,null,function*(){return yield this._initialize()}))}),yield this.initializePromise)})}_initialize(){return d(this,null,function*(){try{let e=G()?yield this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){let{data:t,error:i}=yield this._getSessionFromURL(e);if(i)return this._debug("#_initialize()","error detecting session from URL",i),i?.message==="Identity is already linked"||i?.message==="Identity is already linked to another user"?{error:i}:(yield this._removeSession(),{error:i});let{session:n,redirectType:o}=t;return this._debug("#_initialize()","detected session in URL",n,"redirect type",o),yield this._saveSession(n),setTimeout(()=>d(this,null,function*(){o==="recovery"?yield this._notifyAllSubscribers("PASSWORD_RECOVERY",n):yield this._notifyAllSubscribers("SIGNED_IN",n)}),0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(e){return _(e)?{error:e}:{error:new Pe("Unexpected error during initialization",e)}}finally{yield this._handleVisibilityChange(),this._debug("#_initialize()","end")}})}signUp(e){return d(this,null,function*(){var t,i,n;try{yield this._removeSession();let o;if("email"in e){let{email:u,password:p,options:f}=e,x=null,b=null;if(this.flowType==="pkce"){let v=ue();yield ne(this.storage,`${this.storageKey}-code-verifier`,v),x=yield fe(v),b=v===x?"plain":"s256"}o=yield y(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f?.emailRedirectTo,body:{email:u,password:p,data:(t=f?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:x,code_challenge_method:b},xform:oe})}else if("phone"in e){let{phone:u,password:p,options:f}=e;o=yield y(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:p,data:(i=f?.data)!==null&&i!==void 0?i:{},channel:(n=f?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:oe})}else throw new pe("You must provide either an email or phone number and a password");let{data:a,error:l}=o;if(l||!a)return{data:{user:null,session:null},error:l};let c=a.session,h=a.user;return a.session&&(yield this._saveSession(a.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:h,session:c},error:null}}catch(o){if(_(o))return{data:{user:null,session:null},error:o};throw o}})}signInWithPassword(e){return d(this,null,function*(){try{yield this._removeSession();let t;if("email"in e){let{email:o,password:a,options:l}=e;t=yield y(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:ds})}else if("phone"in e){let{phone:o,password:a,options:l}=e;t=yield y(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:ds})}else throw new pe("You must provide either an email or phone number and a password");let{data:i,error:n}=t;return n?{data:{user:null,session:null},error:n}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new je}:(i.session&&(yield this._saveSession(i.session),yield this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:n})}catch(t){if(_(t))return{data:{user:null,session:null},error:t};throw t}})}signInWithOAuth(e){return d(this,null,function*(){var t,i,n,o;return yield this._removeSession(),yield this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})})}exchangeCodeForSession(e){return d(this,null,function*(){return yield this.initializePromise,this._acquireLock(-1,()=>d(this,null,function*(){return this._exchangeCodeForSession(e)}))})}_exchangeCodeForSession(e){return d(this,null,function*(){let t=yield et(this.storage,`${this.storageKey}-code-verifier`),[i,n]=(t??"").split("/"),{data:o,error:a}=yield y(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:oe});return yield Ot(this.storage,`${this.storageKey}-code-verifier`),a?{data:{user:null,session:null,redirectType:null},error:a}:!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new je}:(o.session&&(yield this._saveSession(o.session),yield this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:n??null}),error:a})})}signInWithIdToken(e){return d(this,null,function*(){yield this._removeSession();try{let{options:t,provider:i,token:n,access_token:o,nonce:a}=e,l=yield y(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:n,access_token:o,nonce:a,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:oe}),{data:c,error:h}=l;return h?{data:{user:null,session:null},error:h}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new je}:(c.session&&(yield this._saveSession(c.session),yield this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:h})}catch(t){if(_(t))return{data:{user:null,session:null},error:t};throw t}})}signInWithOtp(e){return d(this,null,function*(){var t,i,n,o,a;try{if(yield this._removeSession(),"email"in e){let{email:l,options:c}=e,h=null,u=null;if(this.flowType==="pkce"){let f=ue();yield ne(this.storage,`${this.storageKey}-code-verifier`,f),h=yield fe(f),u=f===h?"plain":"s256"}let{error:p}=yield y(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c?.data)!==null&&t!==void 0?t:{},create_user:(i=c?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:h,code_challenge_method:u},redirectTo:c?.emailRedirectTo});return{data:{user:null,session:null},error:p}}if("phone"in e){let{phone:l,options:c}=e,{data:h,error:u}=yield y(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c?.data)!==null&&n!==void 0?n:{},create_user:(o=c?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(a=c?.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:h?.message_id},error:u}}throw new pe("You must provide either an email or phone number.")}catch(l){if(_(l))return{data:{user:null,session:null},error:l};throw l}})}verifyOtp(e){return d(this,null,function*(){var t,i;try{e.type!=="email_change"&&e.type!=="phone_change"&&(yield this._removeSession());let n,o;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,o=(i=e.options)===null||i===void 0?void 0:i.captchaToken);let{data:a,error:l}=yield y(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:n,xform:oe});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");let c=a.session,h=a.user;return c?.access_token&&(yield this._saveSession(c),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:h,session:c},error:null}}catch(n){if(_(n))return{data:{user:null,session:null},error:n};throw n}})}signInWithSSO(e){return d(this,null,function*(){var t,i,n;try{yield this._removeSession();let o=null,a=null;if(this.flowType==="pkce"){let l=ue();yield ne(this.storage,`${this.storageKey}-code-verifier`,l),o=yield fe(l),a=l===o?"plain":"s256"}return yield y(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&i!==void 0?i:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:a}),headers:this.headers,xform:mi})}catch(o){if(_(o))return{data:null,error:o};throw o}})}reauthenticate(){return d(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>d(this,null,function*(){return yield this._reauthenticate()}))})}_reauthenticate(){return d(this,null,function*(){try{return yield this._useSession(e=>d(this,null,function*(){let{data:{session:t},error:i}=e;if(i)throw i;if(!t)throw new se;let{error:n}=yield y(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}}))}catch(e){if(_(e))return{data:{user:null,session:null},error:e};throw e}})}resend(e){return d(this,null,function*(){try{e.type!="email_change"&&e.type!="phone_change"&&(yield this._removeSession());let t=`${this.url}/resend`;if("email"in e){let{email:i,type:n,options:o}=e,{error:a}=yield y(this.fetch,"POST",t,{headers:this.headers,body:{email:i,type:n,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){let{phone:i,type:n,options:o}=e,{data:a,error:l}=yield y(this.fetch,"POST",t,{headers:this.headers,body:{phone:i,type:n,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return{data:{user:null,session:null,messageId:a?.message_id},error:l}}throw new pe("You must provide either an email or phone number and a type")}catch(t){if(_(t))return{data:{user:null,session:null},error:t};throw t}})}getSession(){return d(this,null,function*(){return yield this.initializePromise,this._acquireLock(-1,()=>d(this,null,function*(){return this._useSession(e=>d(this,null,function*(){return e}))}))})}_acquireLock(e,t){return d(this,null,function*(){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=d(this,null,function*(){return yield i,yield t()});return this.pendingInLock.push(d(this,null,function*(){try{yield n}catch{}})),n}return yield this.lock(`lock:${this.storageKey}`,e,()=>d(this,null,function*(){this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let i=t();for(this.pendingInLock.push(d(this,null,function*(){try{yield i}catch{}})),yield i;this.pendingInLock.length;){let n=[...this.pendingInLock];yield Promise.all(n),this.pendingInLock.splice(0,n.length)}return yield i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}})}_useSession(e){return d(this,null,function*(){this._debug("#_useSession","begin");try{let t=yield this.__loadSession();return yield e(t)}finally{this._debug("#_useSession","end")}})}__loadSession(){return d(this,null,function*(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null,t=yield et(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),yield this._removeSession())),!e)return{data:{session:null},error:null};let i=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i)return{data:{session:e},error:null};let{session:n,error:o}=yield this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}})}getUser(e){return d(this,null,function*(){return e?yield this._getUser(e):(yield this.initializePromise,this._acquireLock(-1,()=>d(this,null,function*(){return yield this._getUser()})))})}_getUser(e){return d(this,null,function*(){try{return e?yield y(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Y}):yield this._useSession(t=>d(this,null,function*(){var i,n;let{data:o,error:a}=t;if(a)throw a;return yield y(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(n=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&n!==void 0?n:void 0,xform:Y})}))}catch(t){if(_(t))return{data:{user:null},error:t};throw t}})}updateUser(i){return d(this,arguments,function*(e,t={}){return yield this.initializePromise,yield this._acquireLock(-1,()=>d(this,null,function*(){return yield this._updateUser(e,t)}))})}_updateUser(i){return d(this,arguments,function*(e,t={}){try{return yield this._useSession(n=>d(this,null,function*(){let{data:o,error:a}=n;if(a)throw a;if(!o.session)throw new se;let l=o.session,c=null,h=null;if(this.flowType==="pkce"&&e.email!=null){let f=ue();yield ne(this.storage,`${this.storageKey}-code-verifier`,f),c=yield fe(f),h=f===c?"plain":"s256"}let{data:u,error:p}=yield y(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:h}),jwt:l.access_token,xform:Y});if(p)throw p;return l.user=u.user,yield this._saveSession(l),yield this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}}))}catch(n){if(_(n))return{data:{user:null},error:n};throw n}})}_decodeJWT(e){return hs(e)}setSession(e){return d(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>d(this,null,function*(){return yield this._setSession(e)}))})}_setSession(e){return d(this,null,function*(){try{if(!e.access_token||!e.refresh_token)throw new se;let t=Date.now()/1e3,i=t,n=!0,o=null,a=hs(e.access_token);if(a.exp&&(i=a.exp,n=i<=t),n){let{session:l,error:c}=yield this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};o=l}else{let{data:l,error:c}=yield this._getUser(e.access_token);if(c)throw c;o={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:i-t,expires_at:i},yield this._saveSession(o),yield this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(t){if(_(t))return{data:{session:null,user:null},error:t};throw t}})}refreshSession(e){return d(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>d(this,null,function*(){return yield this._refreshSession(e)}))})}_refreshSession(e){return d(this,null,function*(){try{return yield this._useSession(t=>d(this,null,function*(){var i;if(!e){let{data:a,error:l}=t;if(l)throw l;e=(i=a.session)!==null&&i!==void 0?i:void 0}if(!e?.refresh_token)throw new se;let{session:n,error:o}=yield this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}}))}catch(t){if(_(t))return{data:{user:null,session:null},error:t};throw t}})}_getSessionFromURL(e){return d(this,null,function*(){try{if(!G())throw new me("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new me("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new st("Not a valid PKCE flow url.");let t=St(window.location.href);if(e){if(!t.code)throw new st("No code detected.");let{data:T,error:O}=yield this._exchangeCodeForSession(t.code);if(O)throw O;let A=new URL(window.location.href);return A.searchParams.delete("code"),window.history.replaceState(window.history.state,"",A.toString()),{data:{session:T.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new me(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});let{provider_token:i,provider_refresh_token:n,access_token:o,refresh_token:a,expires_in:l,expires_at:c,token_type:h}=t;if(!o||!l||!a||!h)throw new me("No session defined in URL");let u=Math.round(Date.now()/1e3),p=parseInt(l),f=u+p;c&&(f=parseInt(c));let x=f-u;x*1e3<=it&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${p}s`);let b=f-p;u-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,f,u):u-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",b,f,u);let{data:v,error:m}=yield this._getUser(o);if(m)throw m;let g={provider_token:i,provider_refresh_token:n,access_token:o,expires_in:p,expires_at:f,refresh_token:a,token_type:h,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:t.type},error:null}}catch(t){if(_(t))return{data:{session:null,redirectType:null},error:t};throw t}})}_isImplicitGrantFlow(){let e=St(window.location.href);return!!(G()&&(e.access_token||e.error_description))}_isPKCEFlow(){return d(this,null,function*(){let e=St(window.location.href),t=yield et(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)})}signOut(){return d(this,arguments,function*(e={scope:"global"}){return yield this.initializePromise,yield this._acquireLock(-1,()=>d(this,null,function*(){return yield this._signOut(e)}))})}_signOut(){return d(this,arguments,function*({scope:e}={scope:"global"}){return yield this._useSession(t=>d(this,null,function*(){var i;let{data:n,error:o}=t;if(o)return{error:o};let a=(i=n.session)===null||i===void 0?void 0:i.access_token;if(a){let{error:l}=yield this.admin.signOut(a,e);if(l&&!(fi(l)&&(l.status===404||l.status===401)))return{error:l}}return e!=="others"&&(yield this._removeSession(),yield Ot(this.storage,`${this.storageKey}-code-verifier`),yield this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}}))})}onAuthStateChange(e){let t=ci(),i={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,i),d(this,null,function*(){yield this.initializePromise,yield this._acquireLock(-1,()=>d(this,null,function*(){this._emitInitialSession(t)}))}),{data:{subscription:i}}}_emitInitialSession(e){return d(this,null,function*(){return yield this._useSession(t=>d(this,null,function*(){var i,n;try{let{data:{session:o},error:a}=t;if(a)throw a;yield(i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",o),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){yield(n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}}))})}resetPasswordForEmail(i){return d(this,arguments,function*(e,t={}){let n=null,o=null;if(this.flowType==="pkce"){let a=ue();yield ne(this.storage,`${this.storageKey}-code-verifier`,`${a}/PASSWORD_RECOVERY`),n=yield fe(a),o=a===n?"plain":"s256"}try{return yield y(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:o,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(_(a))return{data:null,error:a};throw a}})}getUserIdentities(){return d(this,null,function*(){var e;try{let{data:t,error:i}=yield this.getUser();if(i)throw i;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(_(t))return{data:null,error:t};throw t}})}linkIdentity(e){return d(this,null,function*(){var t;try{let{data:i,error:n}=yield this._useSession(o=>d(this,null,function*(){var a,l,c,h,u;let{data:p,error:f}=o;if(f)throw f;let x=yield this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return yield y(this.fetch,"GET",x,{headers:this.headers,jwt:(u=(h=p.session)===null||h===void 0?void 0:h.access_token)!==null&&u!==void 0?u:void 0})}));if(n)throw n;return G()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(i?.url),{data:{provider:e.provider,url:i?.url},error:null}}catch(i){if(_(i))return{data:{provider:e.provider,url:null},error:i};throw i}})}unlinkIdentity(e){return d(this,null,function*(){try{return yield this._useSession(t=>d(this,null,function*(){var i,n;let{data:o,error:a}=t;if(a)throw a;return yield y(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&n!==void 0?n:void 0})}))}catch(t){if(_(t))return{data:null,error:t};throw t}})}_refreshAccessToken(e){return d(this,null,function*(){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{let i=Date.now();return yield ui(n=>d(this,null,function*(){return yield di(n*200),this._debug(t,"refreshing attempt",n),yield y(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:oe})}),(n,o,a)=>a&&a.error&&Rt(a.error)&&Date.now()+(n+1)*200-i<it)}catch(i){if(this._debug(t,"error",i),_(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(t,"end")}})}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}_handleProviderSignIn(e,t){return d(this,null,function*(){let i=yield this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",i),G()&&!t.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}})}_recoverAndRefresh(){return d(this,null,function*(){var e;let t="#_recoverAndRefresh()";this._debug(t,"begin");try{let i=yield et(this.storage,this.storageKey);if(this._debug(t,"session from storage",i),!this._isValidSession(i)){this._debug(t,"session is not valid"),i!==null&&(yield this._removeSession());return}let n=Math.round(Date.now()/1e3),o=((e=i.expires_at)!==null&&e!==void 0?e:1/0)<n+us;if(this._debug(t,`session has${o?"":" not"} expired with margin of ${us}s`),o){if(this.autoRefreshToken&&i.refresh_token){let{error:a}=yield this._callRefreshToken(i.refresh_token);a&&(console.error(a),Rt(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),yield this._removeSession()))}}else yield this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(t,"error",i),console.error(i);return}finally{this._debug(t,"end")}})}_callRefreshToken(e){return d(this,null,function*(){var t,i;if(!e)throw new se;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Ze;let{data:o,error:a}=yield this._refreshAccessToken(e);if(a)throw a;if(!o.session)throw new se;yield this._saveSession(o.session),yield this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);let l={session:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(n,"error",o),_(o)){let a={session:null,error:o};return Rt(o)||(yield this._removeSession(),yield this._notifyAllSubscribers("SIGNED_OUT",null)),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(o),o}finally{this.refreshingDeferred=null,this._debug(n,"end")}})}_notifyAllSubscribers(e,t,i=!0){return d(this,null,function*(){let n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:t});let o=[],a=Array.from(this.stateChangeEmitters.values()).map(l=>d(this,null,function*(){try{yield l.callback(e,t)}catch(c){o.push(c)}}));if(yield Promise.all(a),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(n,"end")}})}_saveSession(e){return d(this,null,function*(){this._debug("#_saveSession()",e),yield ne(this.storage,this.storageKey,e)})}_removeSession(){return d(this,null,function*(){this._debug("#_removeSession()"),yield Ot(this.storage,this.storageKey)})}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&G()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}_startAutoRefresh(){return d(this,null,function*(){yield this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),it);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(()=>d(this,null,function*(){yield this.initializePromise,yield this._autoRefreshTokenTick()}),0)})}_stopAutoRefresh(){return d(this,null,function*(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)})}startAutoRefresh(){return d(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return d(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return d(this,null,function*(){this._debug("#_autoRefreshTokenTick()","begin");try{yield this._acquireLock(0,()=>d(this,null,function*(){try{let e=Date.now();try{return yield this._useSession(t=>d(this,null,function*(){let{data:{session:i}}=t;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let n=Math.floor((i.expires_at*1e3-e)/it);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${it}ms, refresh threshold is ${Ti} ticks`),n<=Ti&&(yield this._callRefreshToken(i.refresh_token))}))}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(e.isAcquireTimeout||e instanceof It)this._debug("auto refresh token tick lock not available");else throw e}})}_handleVisibilityChange(){return d(this,null,function*(){if(this._debug("#_handleVisibilityChange()"),!G()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>d(this,null,function*(){return yield this._onVisibilityChanged(!1)}),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}})}_onVisibilityChanged(e){return d(this,null,function*(){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(yield this.initializePromise,yield this._acquireLock(-1,()=>d(this,null,function*(){if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}yield this._recoverAndRefresh()})))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(e,t,i){return d(this,null,function*(){let n=[`provider=${encodeURIComponent(t)}`];if(i?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i?.scopes&&n.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){let o=ue();yield ne(this.storage,`${this.storageKey}-code-verifier`,o);let a=yield fe(o),l=o===a?"plain":"s256";this._debug("PKCE","code verifier",`${o.substring(0,5)}...`,"code challenge",a,"method",l);let c=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(l)}`});n.push(c.toString())}if(i?.queryParams){let o=new URLSearchParams(i.queryParams);n.push(o.toString())}return i?.skipBrowserRedirect&&n.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${n.join("&")}`})}_unenroll(e){return d(this,null,function*(){try{return yield this._useSession(t=>d(this,null,function*(){var i;let{data:n,error:o}=t;return o?{data:null,error:o}:yield y(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=n?.session)===null||i===void 0?void 0:i.access_token})}))}catch(t){if(_(t))return{data:null,error:t};throw t}})}_enroll(e){return d(this,null,function*(){try{return yield this._useSession(t=>d(this,null,function*(){var i,n;let{data:o,error:a}=t;if(a)return{data:null,error:a};let{data:l,error:c}=yield y(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(i=o?.session)===null||i===void 0?void 0:i.access_token});return c?{data:null,error:c}:(!((n=l?.totp)===null||n===void 0)&&n.qr_code&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})}))}catch(t){if(_(t))return{data:null,error:t};throw t}})}_verify(e){return d(this,null,function*(){return this._acquireLock(-1,()=>d(this,null,function*(){try{return yield this._useSession(t=>d(this,null,function*(){var i;let{data:n,error:o}=t;if(o)return{data:null,error:o};let{data:a,error:l}=yield y(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(i=n?.session)===null||i===void 0?void 0:i.access_token});return l?{data:null,error:l}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),yield this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:l})}))}catch(t){if(_(t))return{data:null,error:t};throw t}}))})}_challenge(e){return d(this,null,function*(){return this._acquireLock(-1,()=>d(this,null,function*(){try{return yield this._useSession(t=>d(this,null,function*(){var i;let{data:n,error:o}=t;return o?{data:null,error:o}:yield y(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(i=n?.session)===null||i===void 0?void 0:i.access_token})}))}catch(t){if(_(t))return{data:null,error:t};throw t}}))})}_challengeAndVerify(e){return d(this,null,function*(){let{data:t,error:i}=yield this._challenge({factorId:e.factorId});return i?{data:null,error:i}:yield this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})})}_listFactors(){return d(this,null,function*(){let{data:{user:e},error:t}=yield this.getUser();if(t)return{data:null,error:t};let i=e?.factors||[],n=i.filter(o=>o.factor_type==="totp"&&o.status==="verified");return{data:{all:i,totp:n},error:null}})}_getAuthenticatorAssuranceLevel(){return d(this,null,function*(){return this._acquireLock(-1,()=>d(this,null,function*(){return yield this._useSession(e=>d(this,null,function*(){var t,i;let{data:{session:n},error:o}=e;if(o)return{data:null,error:o};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let a=this._decodeJWT(n.access_token),l=null;a.aal&&(l=a.aal);let c=l;((i=(t=n.user.factors)===null||t===void 0?void 0:t.filter(p=>p.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(c="aal2");let u=a.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}))})}}return r.nextInstanceID=0,r})();var Cr=ps,ms=Cr;var $t=class extends ms{constructor(s){super(s)}};var Sr=function(r,s,e,t){function i(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function a(h){try{c(t.next(h))}catch(u){o(u)}}function l(h){try{c(t.throw(h))}catch(u){o(u)}}function c(h){h.done?n(h.value):i(h.value).then(a,l)}c((t=t.apply(r,s||[])).next())})},Dt=class{constructor(s,e,t){var i,n,o;if(this.supabaseUrl=s,this.supabaseKey=e,!s)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");let a=oi(s);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;let l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:si,realtime:ri,auth:Object.assign(Object.assign({},ii),{storageKey:l}),global:ti},h=ai(t??{},c);this.storageKey=(i=h.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(n=h.global.headers)!==null&&n!==void 0?n:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(u,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=ni(e,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new qs(`${a}/rest/v1`,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new Ne(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Qe(this.storageUrl,this.headers,this.fetch)}from(s){return this.rest.from(s)}schema(s){return this.rest.schema(s)}rpc(s,e={},t={}){return this.rest.rpc(s,e,t)}channel(s,e={config:{}}){return this.realtime.channel(s,e)}getChannels(){return this.realtime.getChannels()}removeChannel(s){return this.realtime.removeChannel(s)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var s,e;return Sr(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();let{data:t}=yield this.auth.getSession();return(e=(s=t.session)===null||s===void 0?void 0:s.access_token)!==null&&e!==void 0?e:null})}_initSupabaseAuthClient({autoRefreshToken:s,persistSession:e,detectSessionInUrl:t,storage:i,storageKey:n,flowType:o,lock:a,debug:l},c,h){var u;let p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new $t({url:this.authUrl,headers:Object.assign(Object.assign({},p),c),storageKey:n,autoRefreshToken:s,persistSession:e,detectSessionInUrl:t,storage:i,flowType:o,lock:a,debug:l,fetch:h,hasCustomAuthorizationHeader:(u="Authorization"in this.headers)!==null&&u!==void 0?u:!1})}_initRealtimeClient(s){return new We(this.realtimeUrl,Object.assign(Object.assign({},s),{params:Object.assign({apikey:this.supabaseKey},s?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t?.access_token)})}_handleTokenChanged(s,e,t){(s==="TOKEN_REFRESHED"||s==="SIGNED_IN")&&this.changedAccessToken!==t?this.changedAccessToken=t:s==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};var ki=(r,s,e)=>new Dt(r,s,e);var Lt=class r{supabaseClient;constructor(){this.supabaseClient=ki(Jt.supabaseUrl,Jt.supabaseKey)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=rt({token:r,factory:r.\u0275fac,providedIn:"root"})};var Si=class r{_supabaseClient=nt(Lt).supabaseClient;signUp(s){return this._supabaseClient.auth.signUp(s)}signIn(s){return this._supabaseClient.auth.signInWithPassword(s)}session(){return this._supabaseClient.auth.getSession()}logOut(){return this._supabaseClient.auth.signOut()}getUserId(){return d(this,null,function*(){let{data:{session:s}}=yield this.session();if(!s?.user.id)throw new Error("No hay usuario autenticado");return s.user.id})}static \u0275fac=function(e){return new(e||r)};static \u0275prov=rt({token:r,factory:r.\u0275fac,providedIn:"root"})};function Er(r,s){r&1&&(_e(),j(0,"svg",0),z(1,"path",2),D())}function Or(r,s){r&1&&(_e(),j(0,"svg",0),z(1,"path",3),D())}function Pr(r,s){r&1&&(_e(),j(0,"svg",0),z(1,"path",4),D())}function jr(r,s){r&1&&(_e(),j(0,"svg",1),z(1,"path",5)(2,"path",6),D())}function Rr(r,s){r&1&&z(0,"div",2)}var Ar=["toastRef"],Pi=[[["","loading-icon",""]],[["","success-icon",""]],[["","error-icon",""]],[["","warning-icon",""]],[["","info-icon",""]]],ji=["[loading-icon]","[success-icon]","[error-icon]","[warning-icon]","[info-icon]"];function Ir(r,s){if(r&1){let e=ye();j(0,"button",3),we("click",function(){B(e);let i=k();return N(i.onCloseButtonClick())}),_e(),j(1,"svg",4),z(2,"line",5)(3,"line",6),D()()}if(r&2){let e,t=k();Z(t.cn(t.classes().closeButton,(e=t.toast().classes)==null?null:e.closeButton)),ve("data-disabled",t.disabled())}}function $r(r,s){r&1&&Le(0)}function Dr(r,s){if(r&1&&($(0,$r,1,0,"ng-container",7),ie(1,"asComponent")),r&2){let e=k();X("ngComponentOutlet",ae(1,2,e.toast().component))("ngComponentOutletInputs",e.toast().componentProps)}}function Lr(r,s){r&1&&K(0)}function Ur(r,s){r&1&&Le(0)}function Fr(r,s){if(r&1&&($(0,Ur,1,0,"ng-container",7),ie(1,"asComponent")),r&2){let e=k(3);X("ngComponentOutlet",ae(1,2,e.toast().icon))("ngComponentOutletInputs",e.toast().componentProps)}}function Br(r,s){r&1&&K(0,1)}function Nr(r,s){r&1&&K(0,2)}function Mr(r,s){r&1&&K(0,3)}function qr(r,s){r&1&&K(0,4)}function Vr(r,s){if(r&1&&$(0,Br,1,0)(1,Nr,1,0)(2,Mr,1,0)(3,qr,1,0),r&2){let e,t=k(3);F((e=t.toastType())==="success"?0:e==="error"?1:e==="warning"?2:e==="info"?3:-1)}}function zr(r,s){if(r&1&&(j(0,"div",8),$(1,Lr,1,0)(2,Fr,2,4,"ng-container")(3,Vr,4,1),D()),r&2){let e=k(2);U(),F(e.toastType()==="loading"&&!e.toast().icon?1:-1),U(),F(e.toast().icon?2:3)}}function Hr(r,s){if(r&1&&Ue(0),r&2){let e=k(3);Fe(" ",e.toast().title," ")}}function Jr(r,s){r&1&&Le(0)}function Kr(r,s){if(r&1&&($(0,Jr,1,0,"ng-container",7),ie(1,"asComponent")),r&2){let e=k(),t=k(2);X("ngComponentOutlet",ae(1,2,e))("ngComponentOutletInputs",t.toast().componentProps)}}function Gr(r,s){if(r&1&&(j(0,"div",14),$(1,Hr,1,1),ie(2,"isString"),$(3,Kr,2,4,"ng-container"),D()),r&2){let e,t=k(2);Z(t.cn(t.classes().title,(e=t.toast().classes)==null?null:e.title)),U(),F(ae(2,3,s)?1:3)}}function Wr(r,s){if(r&1&&Ue(0),r&2){let e=k(3);Fe(" ",e.toast().description," ")}}function Yr(r,s){r&1&&Le(0)}function Qr(r,s){if(r&1&&($(0,Yr,1,0,"ng-container",7),ie(1,"asComponent")),r&2){let e=k(),t=k(2);X("ngComponentOutlet",ae(1,2,e))("ngComponentOutletInputs",t.toast().componentProps)}}function Xr(r,s){if(r&1&&(j(0,"div",15),$(1,Wr,1,1),ie(2,"isString"),$(3,Qr,2,4,"ng-container"),D()),r&2){let e,t=k(2);Z(t.cn(t.descriptionClass(),t.toastDescriptionClass(),t.classes().description,(e=t.toast().classes)==null?null:e.description)),U(),F(ae(2,3,s)?1:3)}}function Zr(r,s){if(r&1){let e=ye();j(0,"button",16),we("click",function(){B(e);let i=k(2);return N(i.onCancelClick())}),Ue(1),D()}if(r&2){let e,t,i=k(2);De((e=i.cancelButtonStyle())!==null&&e!==void 0?e:i.toast().cancelButtonStyle),Z(i.cn(i.classes().cancelButton,(t=i.toast().classes)==null?null:t.cancelButton)),U(),Fe(" ",s.label," ")}}function en(r,s){if(r&1){let e=ye();j(0,"button",17),we("click",function(i){B(e);let n=k(2);return N(n.onActionClick(i))}),Ue(1),D()}if(r&2){let e,t,i=k(2);De((e=i.actionButtonStyle())!==null&&e!==void 0?e:i.toast().actionButtonStyle),Z(i.cn(i.classes().actionButton,(t=i.toast().classes)==null?null:t.actionButton)),U(),Fe(" ",s.label," ")}}function tn(r,s){if(r&1&&($(0,zr,4,2,"div",8),j(1,"div",9),$(2,Gr,4,5,"div",10)(3,Xr,4,5,"div",11),D(),$(4,Zr,2,5,"button",12)(5,en,2,5,"button",13)),r&2){let e,t,i,n,o=k();F(o.toastType()!=="default"||o.toast().icon||o.toast().promise?0:-1),U(2),F((e=o.toast().title)?2:-1,e),U(),F((t=o.toast().description)?3:-1,t),U(),F((i=o.toast().cancel)?4:-1,i),U(),F((n=o.toast().action)?5:-1,n)}}var sn=["listRef"],rn=(r,s)=>s.id,nn=()=>({});function on(r,s){if(r&1&&z(0,"ngx-sonner-loader",6),r&2){let e=k().$implicit;X("isVisible",e.type==="loading")}}function an(r,s){r&1&&z(0,"ngx-sonner-icon",7)}function ln(r,s){r&1&&z(0,"ngx-sonner-icon",8)}function cn(r,s){r&1&&z(0,"ngx-sonner-icon",9)}function hn(r,s){r&1&&z(0,"ngx-sonner-icon",10)}function dn(r,s){if(r&1&&(j(0,"ngx-sonner-toast",5),K(1,0,["loading-icon",""],on,1,1),K(3,1,["success-icon",""],an,1,0),K(5,2,["error-icon",""],ln,1,0),K(7,3,["warning-icon",""],cn,1,0),K(9,4,["info-icon",""],hn,1,0),D()),r&2){let e,t,i,n,o,a=s.$implicit,l=s.$index,c=k(3);Z((e=c.toastOptions().class)!==null&&e!==void 0?e:""),X("index",l)("toast",a)("invert",c.invert())("visibleToasts",c.visibleToasts())("closeButton",c.closeButton())("interacting",c.interacting())("position",c.position())("expandByDefault",c.expand())("expanded",c.expanded())("actionButtonStyle",c.toastOptions().actionButtonStyle)("cancelButtonStyle",c.toastOptions().cancelButtonStyle)("descriptionClass",(t=c.toastOptions().descriptionClass)!==null&&t!==void 0?t:"")("classes",(i=c.toastOptions().classes)!==null&&i!==void 0?i:bs(17,nn))("duration",(n=c.toastOptions().duration)!==null&&n!==void 0?n:c.duration())("unstyled",(o=c.toastOptions().unstyled)!==null&&o!==void 0?o:!1)}}function un(r,s){if(r&1){let e=ye();j(0,"ol",3,0),we("blur",function(i){B(e);let n=k(2);return N(n.handleBlur(i))})("focus",function(i){B(e);let n=k(2);return N(n.handleFocus(i))})("mouseenter",function(){B(e);let i=k(2);return N(i.expanded.set(!0))})("mousemove",function(){B(e);let i=k(2);return N(i.expanded.set(!0))})("mouseleave",function(){B(e);let i=k(2);return N(i.handleMouseLeave())})("pointerdown",function(i){B(e);let n=k(2);return N(n.handlePointerDown(i))})("pointerup",function(){B(e);let i=k(2);return N(i.interacting.set(!1))}),at(2,dn,11,18,"ngx-sonner-toast",4,rn),ie(4,"toastFilter"),D()}if(r&2){let e=s.$implicit,t=s.$index,i=k(2);De(i.toasterStyles()),Z(i._class()),X("tabIndex",-1),ve("data-theme",i.actualTheme())("data-rich-colors",i.richColors())("dir",i.dir()==="auto"?i.getDocumentDirection():i.dir())("data-y-position",e.split("-")[0])("data-x-position",e.split("-")[1]),U(2),lt(xs(4,10,i.toasts(),t,e))}}function fn(r,s){if(r&1&&(j(0,"section",1),at(1,un,5,14,"ol",2,ws),D()),r&2){let e=k();X("tabIndex",-1),ve("aria-label","Notifications "+e.hotKeyLabel()),U(),lt(e.possiblePositions())}}var Ei=0;function pn(){let r=V([]),s=V([]);function e(m){r.update(g=>[m,...g])}function t(m){let gs=m,{message:g}=gs,T=_s(gs,["message"]),O=typeof m?.id=="number"||m.id&&m.id?.length>0?m.id:Ei++,A=m.dismissible??!0,I=m.type??"default";return r().find(Ft=>Ft.id===O)?r.update(Ft=>Ft.map(Bt=>Bt.id===O?J(P(P({},Bt),m),{id:O,title:g,dismissible:A,type:I,updated:!0}):J(P({},Bt),{updated:!1}))):e(J(P({},T),{id:O,title:g,dismissible:A,type:I})),O}function i(m){if(m===void 0){r.set([]);return}return r.update(g=>g.filter(T=>T.id!==m)),m}function n(m,g){return t(J(P({},g),{type:"default",message:m}))}function o(m,g){return t(J(P({},g),{type:"error",message:m}))}function a(m,g){return t(J(P({},g),{type:"success",message:m}))}function l(m,g){return t(J(P({},g),{type:"info",message:m}))}function c(m,g){return t(J(P({},g),{type:"warning",message:m}))}function h(m,g){return t(J(P({},g),{type:"loading",message:m}))}function u(m,g){if(!g)return;let T;g.loading!==void 0&&(T=t(J(P({},g),{promise:m,type:"loading",message:g.loading})));let O=m instanceof Promise?m:m(),A=T!==void 0;return O.then(I=>{if(I&&typeof I.ok=="boolean"&&!I.ok){A=!1;let ge=typeof g.error=="function"?g.error(`HTTP error! status: ${I.status}`):g.error;t({id:T,type:"error",message:ge})}else if(g.success!==void 0){A=!1;let ge=typeof g.success=="function"?g.success(I):g.success;t({id:T,type:"success",message:ge})}}).catch(I=>{if(g.error!==void 0){A=!1;let ge=typeof g.error=="function"?g.error(I):g.error;t({id:T,type:"error",message:ge})}}).finally(()=>{A&&(i(T),T=void 0),g.finally?.()}),T}function p(m,g){let T=g?.id??Ei++;return t(P({component:m,id:T},g)),T}function f(m){s.update(g=>g.filter(T=>T.toastId!==m))}function x(m){s.update(g=>[m,...g].sort(b))}let b=(m,g)=>r().findIndex(T=>T.id===m.toastId)-r().findIndex(T=>T.id===g.toastId);function v(){r.set([]),s.set([])}return{create:t,addToast:e,dismiss:i,message:n,error:o,success:a,info:l,warning:c,loading:h,promise:u,custom:p,removeHeight:f,addHeight:x,reset:v,toasts:r.asReadonly(),heights:s.asReadonly()}}var R=pn();function mn(r,s){return R.create(P({message:r},s))}var gn=mn,Pl=Object.assign(gn,{success:R.success,info:R.info,warning:R.warning,error:R.error,custom:R.custom,message:R.message,promise:R.promise,dismiss:R.dismiss,loading:R.loading}),_n=(()=>{class r{constructor(){this.type=w("default")}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=$e({type:r,selectors:[["ngx-sonner-icon"]],inputs:{type:[1,"type"]},decls:4,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor","height","20","width","20"],["viewBox","0 0 64 64","fill","currentColor","height","20","width","20","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z","clip-rule","evenodd"],["fill-rule","evenodd","d","M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z","clip-rule","evenodd"],["fill-rule","evenodd","d","M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z","clip-rule","evenodd"],["d","M32.427,7.987c2.183,0.124 4,1.165 5.096,3.281l17.936,36.208c1.739,3.66 -0.954,8.585 -5.373,8.656l-36.119,0c-4.022,-0.064 -7.322,-4.631 -5.352,-8.696l18.271,-36.207c0.342,-0.65 0.498,-0.838 0.793,-1.179c1.186,-1.375 2.483,-2.111 4.748,-2.063Zm-0.295,3.997c-0.687,0.034 -1.316,0.419 -1.659,1.017c-6.312,11.979 -12.397,24.081 -18.301,36.267c-0.546,1.225 0.391,2.797 1.762,2.863c12.06,0.195 24.125,0.195 36.185,0c1.325,-0.064 2.321,-1.584 1.769,-2.85c-5.793,-12.184 -11.765,-24.286 -17.966,-36.267c-0.366,-0.651 -0.903,-1.042 -1.79,-1.03Z"],["d","M33.631,40.581l-3.348,0l-0.368,-16.449l4.1,0l-0.384,16.449Zm-3.828,5.03c0,-0.609 0.197,-1.113 0.592,-1.514c0.396,-0.4 0.935,-0.601 1.618,-0.601c0.684,0 1.223,0.201 1.618,0.601c0.395,0.401 0.593,0.905 0.593,1.514c0,0.587 -0.193,1.078 -0.577,1.473c-0.385,0.395 -0.929,0.593 -1.634,0.593c-0.705,0 -1.249,-0.198 -1.634,-0.593c-0.384,-0.395 -0.576,-0.886 -0.576,-1.473Z"]],template:function(t,i){if(t&1&&$(0,Er,2,0,":svg:svg",0)(1,Or,2,0,":svg:svg",0)(2,Pr,2,0,":svg:svg",0)(3,jr,3,0,":svg:svg",1),t&2){let n;F((n=i.type())==="success"?0:n==="error"?1:n==="info"?2:n==="warning"?3:-1)}},encapsulation:2,changeDetection:0})}}return r})(),vn=3,yn="32px",Ut=4e3,wn=356,Ri=14,bn=20,xn=200,Tn={toast:"",title:"",description:"",loader:"",closeButton:"",cancelButton:"",actionButton:"",action:"",warning:"",error:"",success:"",default:"",info:"",loading:""},kn=(()=>{class r{constructor(){this.isVisible=w.required({transform:be}),this.bars=Array(12).fill(0)}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=$e({type:r,selectors:[["ngx-sonner-loader"]],inputs:{isVisible:[1,"isVisible"]},decls:4,vars:1,consts:[[1,"sonner-loading-wrapper"],[1,"sonner-spinner"],[1,"sonner-loading-bar"]],template:function(t,i){t&1&&(j(0,"div",0)(1,"div",1),at(2,Rr,1,0,"div",2,ys),D()()),t&2&&(ve("data-visible",i.isVisible()),U(2),lt(i.bars))},encapsulation:2,changeDetection:0})}}return r})(),Cn=(()=>{class r{transform(e,t,i){return e.filter(n=>!n.position&&t===0||n.position===i)}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275pipe=ot({name:"toastFilter",type:r,pure:!0})}}return r})();function Oi(...r){return r.filter(Boolean).join(" ")}var Sn=(()=>{class r{transform(e){return e}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275pipe=ot({name:"asComponent",type:r,pure:!0})}}return r})(),En=(()=>{class r{transform(e){return typeof e=="string"}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275pipe=ot({name:"isString",type:r,pure:!0})}}return r})(),On=(()=>{class r{constructor(){this.cn=Oi,this.toasts=R.toasts,this.heights=R.heights,this.removeHeight=R.removeHeight,this.addHeight=R.addHeight,this.dismiss=R.dismiss,this.toast=w.required(),this.index=w.required(),this.expanded=w.required(),this._invert=w.required({alias:"invert"}),this.position=w.required(),this.visibleToasts=w.required(),this.expandByDefault=w.required(),this._closeButton=w.required({alias:"closeButton"}),this.interacting=w.required(),this.cancelButtonStyle=w(),this.actionButtonStyle=w(),this.duration=w(Ut),this.descriptionClass=w(""),this._classes=w({},{alias:"classes"}),this.unstyled=w(!1),this._class=w("",{alias:"class"}),this._style=w({},{alias:"style"}),this.mounted=V(!1),this.removed=V(!1),this.swiping=V(!1),this.swipeOut=V(!1),this.offsetBeforeRemove=V(0),this.initialHeight=V(0),this.toastRef=Nt.required("toastRef"),this.classes=S(()=>P(P({},Tn),this._classes())),this.isFront=S(()=>this.index()===0),this.isVisible=S(()=>this.index()+1<=this.visibleToasts()),this.toastType=S(()=>this.toast().type??"default"),this.toastClass=S(()=>this.toast().class??""),this.toastPosition=S(()=>this.toast().position??this.position()),this.toastDescriptionClass=S(()=>this.toast().descriptionClass??""),this.heightIndex=S(()=>this.heights().findIndex(e=>e.toastId===this.toast().id)),this.offset=ct({source:()=>({heightIndex:this.heightIndex(),toastsHeightBefore:this.toastsHeightBefore()}),computation:({heightIndex:e,toastsHeightBefore:t})=>Math.round(e*Ri+t)}),this.closeTimerStartTimeRef=0,this.lastCloseTimerStartTimeRef=0,this.pointerStartRef=null,this.coords=S(()=>this.toastPosition().split("-")),this.toastsHeightBefore=S(()=>this.heights().reduce((e,t,i)=>i>=this.heightIndex()?e:e+t.height,0)),this.invert=S(()=>this.toast().invert??this._invert()),this.closeButton=S(()=>this.toast().closeButton??this._closeButton()),this.disabled=S(()=>this.toastType()==="loading"),this.remainingTime=0,this.isPromiseLoadingOrInfiniteDuration=S(()=>this.toast().promise&&this.toastType()==="loading"||this.toast().duration===Number.POSITIVE_INFINITY),this.toastClasses=S(()=>Oi(this._class(),this.toastClass(),this.classes().toast,this.toast().classes?.toast,this.classes()[this.toastType()],this.toast().classes?.[this.toastType()])),this.toastStyle=S(()=>P({"--index":`${this.index()}`,"--toasts-before":`${this.index()}`,"--z-index":`${this.toasts().length-this.index()}`,"--offset":`${this.removed()?this.offsetBeforeRemove():this.offset()}px`,"--initial-height":this.expandByDefault()?"auto":`${this.initialHeight()}px`},this._style())),Ht(()=>{this.toast().updated&&(clearTimeout(this.timeoutId),this.remainingTime=this.toast().duration??this.duration()??Ut,this.startTimer())}),Ts(e=>{this.isPromiseLoadingOrInfiniteDuration()||(this.expanded()||this.interacting()?this.pauseTimer():this.startTimer()),e(()=>clearTimeout(this.timeoutId))}),Ht(()=>{this.toast().delete&&this.deleteToast()})}ngAfterViewInit(){this.remainingTime=this.toast().duration??this.duration()??Ut,this.mounted.set(!0);let e=this.toastRef().nativeElement.getBoundingClientRect().height;this.initialHeight.set(e),this.addHeight({toastId:this.toast().id,height:e})}ngOnDestroy(){clearTimeout(this.timeoutId),this.removeHeight(this.toast().id)}deleteToast(){this.removed.set(!0),this.offsetBeforeRemove.set(this.offset()),this.removeHeight(this.toast().id),setTimeout(()=>{this.dismiss(this.toast().id)},xn)}pauseTimer(){if(this.lastCloseTimerStartTimeRef<this.closeTimerStartTimeRef){let e=new Date().getTime()-this.closeTimerStartTimeRef;this.remainingTime=this.remainingTime-e}this.lastCloseTimerStartTimeRef=new Date().getTime()}startTimer(){this.closeTimerStartTimeRef=new Date().getTime(),this.timeoutId=setTimeout(()=>{this.toast().onAutoClose?.(this.toast()),this.deleteToast()},this.remainingTime)}onPointerDown(e){if(this.disabled()||!this.toast().dismissible)return;this.offsetBeforeRemove.set(this.offset());let t=e.target;t.setPointerCapture(e.pointerId),t.tagName!=="BUTTON"&&(this.swiping.set(!0),this.pointerStartRef={x:e.clientX,y:e.clientY})}onPointerUp(){if(this.swipeOut()||!this.toast().dismissible)return;this.pointerStartRef=null;let e=Number(this.toastRef().nativeElement.style.getPropertyValue("--swipe-amount").replace("px","")||0);if(Math.abs(e)>=bn){this.offsetBeforeRemove.set(this.offset()),this.toast().onDismiss?.(this.toast()),this.deleteToast(),this.swipeOut.set(!0);return}this.toastRef().nativeElement.style.setProperty("--swipe-amount","0px"),this.swiping.set(!1)}onPointerMove(e){if(!this.pointerStartRef||!this.toast().dismissible)return;let t=e.clientY-this.pointerStartRef.y,i=e.clientX-this.pointerStartRef.x,o=(this.coords()[0]==="top"?Math.min:Math.max)(0,t),a=e.pointerType==="touch"?10:2;Math.abs(o)>a?this.toastRef().nativeElement.style.setProperty("--swipe-amount",`${t}px`):Math.abs(i)>a&&(this.pointerStartRef=null)}onCloseButtonClick(){this.disabled()||!this.toast().dismissible||(this.deleteToast(),this.toast().onDismiss?.(this.toast()))}onCancelClick(){let e=this.toast();e.dismissible&&(this.deleteToast(),e.cancel?.onClick&&e.cancel.onClick())}onActionClick(e){this.toast().action?.onClick(e),!e.defaultPrevented&&this.deleteToast()}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=$e({type:r,selectors:[["ngx-sonner-toast"]],viewQuery:function(t,i){t&1&&qt(i.toastRef,Ar,5),t&2&&Vt()},inputs:{toast:[1,"toast"],index:[1,"index"],expanded:[1,"expanded"],_invert:[1,"invert","_invert"],position:[1,"position"],visibleToasts:[1,"visibleToasts"],expandByDefault:[1,"expandByDefault"],_closeButton:[1,"closeButton","_closeButton"],interacting:[1,"interacting"],cancelButtonStyle:[1,"cancelButtonStyle"],actionButtonStyle:[1,"actionButtonStyle"],duration:[1,"duration"],descriptionClass:[1,"descriptionClass"],_classes:[1,"classes","_classes"],unstyled:[1,"unstyled"],_class:[1,"class","_class"],_style:[1,"style","_style"]},ngContentSelectors:ji,decls:5,vars:22,consts:[["toastRef",""],["data-sonner-toast","","aria-atomic","true","role","status","tabindex","0",3,"pointerdown","pointerup","pointermove"],["aria-label","Close toast","data-close-button","",3,"class"],["aria-label","Close toast","data-close-button","",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","12","height","12","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[4,"ngComponentOutlet","ngComponentOutletInputs"],["data-icon",""],["data-content",""],["data-title","",3,"class"],["data-description","",3,"class"],["data-button","","data-cancel","",3,"style","class"],["data-button","",3,"style","class"],["data-title",""],["data-description",""],["data-button","","data-cancel","",3,"click"],["data-button","",3,"click"]],template:function(t,i){if(t&1){let n=ye();Mt(Pi),j(0,"li",1,0),we("pointerdown",function(a){return B(n),N(i.onPointerDown(a))})("pointerup",function(){return B(n),N(i.onPointerUp())})("pointermove",function(a){return B(n),N(i.onPointerMove(a))}),$(2,Ir,4,3,"button",2)(3,Dr,2,4,"ng-container")(4,tn,6,5),D()}t&2&&(De(i.toastStyle()),Z(i.toastClasses()),ve("aria-live",i.toast().important?"assertive":"polite")("data-styled",!(i.toast().component||i.toast().unstyled||i.unstyled()))("data-mounted",i.mounted())("data-promise",!!i.toast().promise)("data-removed",i.removed())("data-visible",i.isVisible())("data-y-position",i.coords()[0])("data-x-position",i.coords()[1])("data-index",i.index())("data-front",i.isFront())("data-swiping",i.swiping())("data-dismissible",i.toast().dismissible)("data-type",i.toastType())("data-invert",i.invert())("data-swipe-out",i.swipeOut())("data-expanded",i.expanded()||i.expandByDefault()&&i.mounted()),U(2),F(i.closeButton()&&!i.toast().component?2:-1),U(),F(i.toast().component?3:4))},dependencies:[ks,En,Sn],encapsulation:2,changeDetection:0})}}return r})(),jl=(()=>{class r{constructor(){this.platformId=nt(vs),this.toasts=R.toasts,this.heights=R.heights,this.reset=R.reset,this.invert=w(!1,{transform:be}),this.theme=w("light"),this.position=w("bottom-right"),this.hotKey=w(["altKey","KeyT"]),this.richColors=w(!1,{transform:be}),this.expand=w(!1,{transform:be}),this.duration=w(Ut,{transform:zt}),this.visibleToasts=w(vn,{transform:zt}),this.closeButton=w(!1,{transform:be}),this.toastOptions=w({}),this.offset=w(null),this.dir=w(this.getDocumentDirection()),this._class=w("",{alias:"class"}),this._style=w({},{alias:"style"}),this.possiblePositions=S(()=>Array.from(new Set([this.position(),...this.toasts().filter(e=>e.position).map(e=>e.position)].filter(Boolean)))),this.expanded=ct({source:this.toasts,computation:e=>e.length<1}),this.actualTheme=ct({source:this.theme,computation:e=>this.getActualTheme(e)}),this.interacting=V(!1),this.listRef=Nt("listRef"),this.lastFocusedElementRef=V(null),this.isFocusWithinRef=V(!1),this.hotKeyLabel=S(()=>this.hotKey().join("+").replace(/Key/g,"").replace(/Digit/g,"")),this.toasterStyles=S(()=>P({"--front-toast-height":`${this.heights()[0]?.height}px`,"--offset":typeof this.offset()=="number"?`${this.offset()}px`:this.offset()??`${yn}`,"--width":`${wn}px`,"--gap":`${Ri}px`},this._style())),this.handleKeydown=e=>{let t=this.listRef()?.nativeElement;if(!t)return;this.hotKey().every(n=>e[n]||e.code===n)&&(this.expanded.set(!0),t.focus()),e.code==="Escape"&&(document.activeElement===t||t.contains(document.activeElement))&&this.expanded.set(!1)},this.handleThemePreferenceChange=({matches:e})=>{this.theme()==="system"&&this.actualTheme.set(e?"dark":"light")},this.reset(),ht(this.platformId)&&(document.addEventListener("keydown",this.handleKeydown),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",this.handleThemePreferenceChange))}ngOnDestroy(){ht(this.platformId)&&(document.removeEventListener("keydown",this.handleKeydown),window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",this.handleThemePreferenceChange))}handleBlur(e){this.isFocusWithinRef()&&!e.target.contains(e.relatedTarget)&&(this.isFocusWithinRef.set(!1),this.lastFocusedElementRef()&&(this.lastFocusedElementRef()?.focus({preventScroll:!0}),this.lastFocusedElementRef.set(null)))}handleFocus(e){e.target instanceof HTMLElement&&e.target.dataset.dismissible==="false"||this.isFocusWithinRef()||(this.isFocusWithinRef.set(!0),this.lastFocusedElementRef.set(e.relatedTarget))}handlePointerDown(e){e.target instanceof HTMLElement&&e.target.dataset.dismissible==="false"||this.interacting.set(!0)}handleMouseLeave(){this.interacting()||this.expanded.set(!1)}getActualTheme(e){return e!=="system"?e:ht(this.platformId)&&window.matchMedia?.("(prefers-color-scheme: dark)").matches?"dark":"light"}getDocumentDirection(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return!e||e==="auto"?window.getComputedStyle(document.documentElement).direction:e}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=$e({type:r,selectors:[["ngx-sonner-toaster"]],viewQuery:function(t,i){t&1&&qt(i.listRef,sn,5),t&2&&Vt()},inputs:{invert:[1,"invert"],theme:[1,"theme"],position:[1,"position"],hotKey:[1,"hotKey"],richColors:[1,"richColors"],expand:[1,"expand"],duration:[1,"duration"],visibleToasts:[1,"visibleToasts"],closeButton:[1,"closeButton"],toastOptions:[1,"toastOptions"],offset:[1,"offset"],dir:[1,"dir"],_class:[1,"class","_class"],_style:[1,"style","_style"]},ngContentSelectors:ji,decls:1,vars:1,consts:[["listRef",""],[3,"tabIndex"],["data-sonner-toaster","",3,"tabIndex","class","style"],["data-sonner-toaster","",3,"blur","focus","mouseenter","mousemove","mouseleave","pointerdown","pointerup","tabIndex"],[3,"index","toast","invert","visibleToasts","closeButton","interacting","position","expandByDefault","expanded","actionButtonStyle","cancelButtonStyle","class","descriptionClass","classes","duration","unstyled"],[3,"index","toast","invert","visibleToasts","closeButton","interacting","position","expandByDefault","expanded","actionButtonStyle","cancelButtonStyle","descriptionClass","classes","duration","unstyled"],[3,"isVisible"],["type","success"],["type","error"],["type","warning"],["type","info"]],template:function(t,i){t&1&&(Mt(Pi),$(0,fn,3,2,"section",1)),t&2&&F(i.toasts().length>0?0:-1)},dependencies:[On,Cn,_n,kn],styles:[`html[dir=ltr],[data-sonner-toaster][dir=ltr]{--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}html[dir=rtl],[data-sonner-toaster][dir=rtl]{--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}[data-sonner-toaster][data-x-position=right]{right:max(var(--offset),env(safe-area-inset-right))}[data-sonner-toaster][data-x-position=left]{left:max(var(--offset),env(safe-area-inset-left))}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translate(-50%)}[data-sonner-toaster][data-y-position=top]{top:max(var(--offset),env(safe-area-inset-top))}[data-sonner-toaster][data-y-position=bottom]{bottom:max(var(--offset),env(safe-area-inset-bottom))}[data-sonner-toast]{--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}[data-sonner-toast][data-y-position=top]{top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}[data-sonner-toast] [data-description]{font-weight:400;line-height:1.4;color:inherit}[data-sonner-toast] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast] [data-icon]>*{flex-shrink:0}[data-sonner-toast] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast] [data-button]:focus-visible{box-shadow:0 0 0 2px #0006}[data-sonner-toast] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast] [data-cancel]{color:var(--normal-text);background:#00000014}[data-sonner-toast][data-theme=dark] [data-cancel]{background:#ffffff4d}[data-sonner-toast] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]:focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}[data-sonner-toast] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]:before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]:before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]:before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]:before{content:"";position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast]:after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y: translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y: translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]:before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - 32px)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true] [data-sonner-toast][data-type=success],[data-rich-colors=true] [data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true] [data-sonner-toast][data-type=info],[data-rich-colors=true] [data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true] [data-sonner-toast][data-type=warning],[data-rich-colors=true] [data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true] [data-sonner-toast][data-type=error],[data-rich-colors=true] [data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`],encapsulation:2,changeDetection:0})}}return r})();export{Jt as a,Lt as b,Si as c,Pl as d,jl as e};
