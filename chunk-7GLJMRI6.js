import{h as St}from"./chunk-ME7OKJUC.js";import{c as J,d as k}from"./chunk-UUBK57OJ.js";import"./chunk-X5YLR3NI.js";import"./chunk-FK6H3RFT.js";import{$ as O,A as rt,G as lt,L as P,M as mt,N as ct,O as st,P as dt,Q as pt,R as ft,S as ut,T as Ct,U as _t,V as gt,W as ht,X as xt,Y as V,_ as bt,aa as M,b as K,c as W,d as X,e as Y,f as Z,g as tt,h as et,l as it,o as y,p as nt,r as at,x as ot}from"./chunk-ESXP6LPB.js";import"./chunk-2PPFUFFT.js";import{b as G,c as U}from"./chunk-H5E3HTG2.js";import"./chunk-BBKHAT7U.js";import{Db as D,Ib as a,Jb as n,Kb as h,Lb as d,Mb as p,Ob as S,Rb as x,Tb as f,Wc as Q,Xa as l,Xb as L,Ya as T,Yb as q,Zb as F,bc as A,ca as v,cc as o,dc as u,eb as b,ec as E,fc as B,ka as _,la as g,lc as $,oc as z,qc as j,ua as N,vb as c,xb as s}from"./chunk-CCAJ3PNG.js";import{i as w}from"./chunk-ODN5LVDJ.js";var R=class t{constructor(i){this.data=i}static \u0275fac=function(e){return new(e||t)(T(K))};static \u0275cmp=b({type:t,selectors:[["app-modal-confirmation"]],decls:9,vars:2,consts:[["mat-dialog-title",""],["align","end"],["mat-button","","mat-dialog-close",""],["mat-button","","color","warn",3,"mat-dialog-close"]],template:function(e,r){e&1&&(a(0,"h2",0),o(1,"Confirmar eliminaci\xF3n"),n(),a(2,"mat-dialog-content"),o(3),n(),a(4,"mat-dialog-actions",1)(5,"button",2),o(6,"Cancelar"),n(),a(7,"button",3),o(8,"Eliminar"),n()()),e&2&&(l(3),E(" \xBFEst\xE1s seguro de que deseas eliminar el certificado de ",r.data,"? "),l(4),s("mat-dialog-close",!0))},dependencies:[M,y,X,Y,tt,Z],encapsulation:2})};var Et=()=>[5,10,25,100];function yt(t,i){t&1&&(a(0,"th",19),o(1,"C\xF3digo"),n())}function Pt(t,i){if(t&1&&(a(0,"td",20),o(1),n()),t&2){let e=i.$implicit;l(),u(e.code)}}function Ot(t,i){t&1&&(a(0,"th",19),o(1,"Estudiante"),n())}function Rt(t,i){if(t&1&&(a(0,"td",20),o(1),n()),t&2){let e=i.$implicit;l(),u(e.studentName)}}function It(t,i){t&1&&(a(0,"th",19),o(1,"N\xFAmero Doc."),n())}function Nt(t,i){if(t&1&&(a(0,"td",20),o(1),n()),t&2){let e=i.$implicit;l(),B("",e.documentType," ",e.documentNumber,"")}}function Lt(t,i){t&1&&(a(0,"th",19),o(1,"Curso"),n())}function qt(t,i){if(t&1&&(a(0,"td",20),o(1),n()),t&2){let e=i.$implicit;l(),u(e.courseName)}}function Ft(t,i){t&1&&(a(0,"th",19),o(1,"Horas"),n())}function Vt(t,i){if(t&1&&(a(0,"td",20),o(1),n()),t&2){let e=i.$implicit;l(),u(e.hours)}}function kt(t,i){t&1&&(a(0,"th",19),o(1,"Email"),n())}function Ht(t,i){if(t&1&&(a(0,"td",20),o(1),n()),t&2){let e=i.$implicit;l(),u(e.email)}}function At(t,i){t&1&&(a(0,"th",19),o(1,"Fecha"),n())}function Bt(t,i){if(t&1&&(a(0,"td",20),o(1),z(2,"date"),n()),t&2){let e=i.$implicit;l(),u(j(2,1,e.created_at,"mediumDate"))}}function $t(t,i){t&1&&h(0,"th",21)}function zt(t,i){if(t&1){let e=S();a(0,"td",20)(1,"button",22),x("click",function(){let m=_(e).$implicit,C=f();return g(C.onDelete(m))}),a(2,"mat-icon"),o(3,"delete"),n()()()}t&2&&(l(),s("matTooltip","Eliminar certificado"))}function jt(t,i){t&1&&h(0,"tr",23)}function Qt(t,i){t&1&&h(0,"tr",24)}function Gt(t,i){if(t&1&&(a(0,"tr",25)(1,"td",26),o(2),n()()),t&2){f();let e=A(4);l(2),E('No hay datos que coincidan con el filtro "',e.value,'"')}}var I=class t{constructor(i){this.dialog=i;this.dataSource=new V([])}sort;paginator;deleteRequest=new N;editRequest=new N;displayedColumns=["code","studentName","documentNumber","courseName","hours","email","created_at","actions"];dataSource;set data(i){let e=i.sort((r,m)=>{let C=r.created_at?new Date(r.created_at):new Date(0);return(m.created_at?new Date(m.created_at):new Date(0)).getTime()-C.getTime()});this.dataSource=new V(e),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.setupFilterPredicate()}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}setupFilterPredicate(){this.dataSource.filterPredicate=(i,e)=>(i.code+i.studentName+i.documentNumber+i.courseName+i.email).toLowerCase().indexOf(e.toLowerCase())!==-1}applyFilter(i){let e=i.target.value;this.dataSource.filter=e.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}onDelete(i){this.dialog.open(R,{width:"350px",data:i.studentName}).afterClosed().subscribe(r=>{r&&this.deleteRequest.emit(i)})}static \u0275fac=function(e){return new(e||t)(T(W))};static \u0275cmp=b({type:t,selectors:[["app-table"]],viewQuery:function(e,r){if(e&1&&(L(P,5),L(O,5)),e&2){let m;q(m=F())&&(r.sort=m.first),q(m=F())&&(r.paginator=m.first)}},inputs:{data:"data"},outputs:{deleteRequest:"deleteRequest",editRequest:"editRequest"},decls:35,vars:6,consts:[["input",""],["matInput","","placeholder","Buscar...",3,"keyup"],[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","code"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","studentName"],["matColumnDef","documentNumber"],["matColumnDef","courseName"],["matColumnDef","hours"],["matColumnDef","email"],["matColumnDef","created_at"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","","aria-label","Seleccionar p\xE1gina de certificados",3,"pageSizeOptions","pageSize"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-icon-button","",3,"click","matTooltip"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","9",1,"mat-cell"]],template:function(e,r){if(e&1){let m=S();a(0,"mat-form-field")(1,"mat-label"),o(2,"Filtrar"),n(),a(3,"input",1,0),x("keyup",function(H){return _(m),g(r.applyFilter(H))}),n()(),a(5,"div",2)(6,"table",3),d(7,4),c(8,yt,2,0,"th",5)(9,Pt,2,1,"td",6),p(),d(10,7),c(11,Ot,2,0,"th",5)(12,Rt,2,1,"td",6),p(),d(13,8),c(14,It,2,0,"th",5)(15,Nt,2,2,"td",6),p(),d(16,9),c(17,Lt,2,0,"th",5)(18,qt,2,1,"td",6),p(),d(19,10),c(20,Ft,2,0,"th",5)(21,Vt,2,1,"td",6),p(),d(22,11),c(23,kt,2,0,"th",5)(24,Ht,2,1,"td",6),p(),d(25,12),c(26,At,2,0,"th",5)(27,Bt,3,4,"td",6),p(),d(28,13),c(29,$t,1,0,"th",14)(30,zt,4,1,"td",6),p(),c(31,jt,1,0,"tr",15)(32,Qt,1,0,"tr",16)(33,Gt,3,1,"tr",17),n(),h(34,"mat-paginator",18),n()}e&2&&(l(6),s("dataSource",r.dataSource),l(25),s("matHeaderRowDef",r.displayedColumns),l(),s("matRowDefColumns",r.displayedColumns),l(2),s("pageSizeOptions",$(5,Et))("pageSize",10))},dependencies:[M,at,it,et,rt,ot,O,P,mt,ct,dt,Ct,pt,st,_t,ft,ut,gt,ht,xt,bt,Q],styles:[".mat-elevation-z8[_ngcontent-%COMP%]{overflow-x:auto}table[_ngcontent-%COMP%]{width:100%;min-width:900px}.mat-column-actions[_ngcontent-%COMP%]{width:120px;text-align:center}.mat-cell[_ngcontent-%COMP%]{padding:8px}.mat-header-cell[_ngcontent-%COMP%]{font-weight:700;color:#000000de}"]})};function Ut(t,i){t&1&&(a(0,"div",6),h(1,"mat-spinner"),n())}function Jt(t,i){if(t&1){let e=S();a(0,"div",7)(1,"p",9),o(2),n(),a(3,"button",10),x("click",function(){_(e);let m=f();return g(m.reloadCertificates())}),o(4," Reintentar "),n()()}if(t&2){let e=f();l(2),u(e.error())}}function Kt(t,i){if(t&1){let e=S();a(0,"app-table",11),x("deleteRequest",function(m){_(e);let C=f();return g(C.onDeleteCertificate(m))})("editRequest",function(m){_(e);let C=f();return g(C.onEditCertificate(m))}),n()}if(t&2){let e=f();s("data",e.certificates())}}var Tt=class t{_authSrv=v(J);_certificateSrv=v(St);_router=v(G);certificates=this._certificateSrv.certificates;loading=this._certificateSrv.loading;error=this._certificateSrv.error;ngOnInit(){this._certificateSrv.list()}reloadCertificates(){this._certificateSrv.list()}onEditCertificate(i){return w(this,null,function*(){this._router.navigate(["/administration/edit",i.id])})}onDeleteCertificate(i){return w(this,null,function*(){try{yield this._certificateSrv.delete(i.id),k.success("Certificado eliminado exitosamente")}catch(e){console.error("Error al eliminar:",e),k.error(e.message||"Error al eliminar el certificado")}})}logout(){return w(this,null,function*(){yield this._authSrv.logOut(),this._router.navigateByUrl("/")})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=b({type:t,selectors:[["app-certificate-list"]],decls:13,vars:3,consts:[[1,"page-container"],[1,"list-container"],[1,"header-actions"],[1,"action-buttons"],["mat-flat-button","","color","warn",3,"click"],["mat-flat-button","","color","primary","routerLink","/administration/new"],[1,"center-content"],[1,"error-content"],[3,"data"],[1,"error-message"],["mat-button","","color","primary",3,"click"],[3,"deleteRequest","editRequest","data"]],template:function(e,r){e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),o(4,"Certificados"),n(),a(5,"div",3)(6,"button",4),x("click",function(){return r.logout()}),o(7," Salir "),n(),a(8,"a",5),o(9," Nuevo Certificado "),n()()(),c(10,Ut,2,0,"div",6)(11,Jt,5,1,"div",7)(12,Kt,1,1,"app-table",8),n()()),e&2&&(l(10),D(r.loading()?10:-1),l(),D(r.error()?11:-1),l(),D(!r.loading()&&!r.error()?12:-1))},dependencies:[M,nt,y,lt,I,U],styles:[".list-container[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:20px;box-shadow:0 2px 4px #0000001a;grid-column:1/-1}.header-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.header-actions[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:24px}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:12px}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .action-buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{min-width:100px}.center-content[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:40px 0}.error-content[_ngcontent-%COMP%]{text-align:center;padding:20px}.error-content[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#f44336;margin-bottom:12px}@media (max-width: 600px){.header-actions[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}.action-buttons[_ngcontent-%COMP%]{width:100%;flex-direction:column}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .action-buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{width:100%}}"]})};export{Tt as CertificateListComponent};
